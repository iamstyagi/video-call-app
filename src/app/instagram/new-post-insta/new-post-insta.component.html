<p-toast></p-toast>
<div class="mainContainer">
    <div class="flex flex-wrap">
        <div class="col-12 mb-0 md:col-3 md:mb-0">
            <span>Account Name:</span> <br>
            <span><input type="text" pInputText [(ngModel)]="acName" style="margin: 0 !important;" readonly></span>
            <!-- <span><input type="text" pInputText [(ngModel)]="to" style="margin: 0 !important;" disabled></span> -->
        </div>
        <div class="col-12 mb-0 md:col-3 md:mb-0" style="padding-top: 32px;">
        </div>
        <!-- <div class="col-12 mb-0 md:col-3 md:mb-0" style="padding-top: 32px;">
            <p-button label="New Ticket" hidden></p-button>
        </div> -->
    </div>
    <div class="col-12 mb-0 md:col-12 md:mb-0">
        <textarea pInputTextarea [(ngModel)]="fbPostTextArea" placeholder="Enter Text"></textarea>
    </div>

    <div>
        <p-fileUpload     (uploadHandler)="uploadHandler($event)" (onUpload)="onUpload($event)" 
        [multiple]="true" customUpload="true" accept="image/*" maxFileSize="50000000">
            <ng-template pTemplate="content">
                <ul *ngIf="uploadedFiles.length">
                    <li *ngFor="let file of uploadedFiles">{{ file.name }} - {{ file.size }} bytes</li>
                </ul>
            </ng-template>
        </p-fileUpload>
    </div>
    <!-- <div class="col-12 mb-0 md:col-3 md:mb-0">
        <p-button label="New Ticket" (click)="newTicket()" [hidden]="!ticketEnable"></p-button>
    
    </div> -->
  
  <!-- ticketing dashboard start -->
  <div class="p-fluid formgrid grid overflow-y-auto" style="padding: 10px;
  width: 100%;
  margin: auto;" *ngIf="newTicketFlag">
  

    <div class="col-12 md:col-12 card"  >
      <i class="pi pi-times-circle" (click)="closeDetailsTicket()" style="font-size: 2rem;
  float: right;
  position: relative;cursor: pointer;
  left: 18px;
  bottom: 7px;"></i>
        <div class="cardTicket dispositioncard2">
            <div class="cardTicket" style="background-color: #1089bec9;
            height: 33px;
            display: flex;
            align-items: center;
            text-align: center;" *ngIf="showTicketCard">
                <ul class="cls-new-css-find" style="display: flex; color:white; margin-top:0rem; margin-bottom:0rem; padding-left:0.5rem;    font-size: 14px;">
                    <li>TicketNo: {{ticketNo}}</li>
                    <span style="margin-left:40px;"></span>
                    <li>Source: {{sourceName}}</li>
                    <span style="margin-left:40px;"></span>
                    <li>Campaign: {{ticketCampaignName}}</li>
                    <span style="margin-left:40px;"></span>
                    <li>ActionNo: {{actionNo}}</li>
                    <span style="margin-left:40px;"></span>
                    <li>Ticket Time: {{ticketTime}}</li>
                    <span style="margin-left:40px;"></span>
                    <li>Duration: {{ticketDuration}}</li>
                </ul>

            </div>
            <div class="" style="    width: 100%; border-bottom: 0.2px dotted #8080809c;" *ngIf="newTicketFlag">
                <div class="col-12 md:col-12" style="padding: 0.3rem;" >
                    <div class="">
                <form [formGroup]="customForm">
                    <div>
                        <div class=" dynamic-form-card">
                            <div class="p-fluid formgrid grid">
                                <ng-container *ngFor="let field of formFields">
                                    <div *ngIf="field.fld_isNewRow==true" style="min-inline-size: -webkit-fill-available !important;">
                                    </div>
                                    <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">{{field.separatorText}}</div>
                                    <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2" *ngIf="field.fld_Enable_Search==false">
                                        <span style="padding-left:10px; ">{{field.name}}</span>
                                    </div>
                                    <div class="field col-12 md:col-2">
                                        <span
                                            *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true && field.fld_Enable_Search==false">
                                            <div
                                                *ngIf="field.name == 'Phone Number' || field.name == 'PhoneNo' || field.name == 'PhoneNo*' || field.name == 'Phone No'">
                                                <input type="text" pInputText [formControlName]="field.fld_FieldName" *ngIf="!isMasked" 
                                                    required="field.required" class="p-inputtext-sm" 
                                                    style=" user-select: none !important;"   >
                
                                                <input type="text" pInputText id="phoneInput" *ngIf="isMasked" required="field.required"
                                                    class="p-inputtext-sm" 
                                                    style=" user-select: none !important;">
                
                                            </div>
                
                                            <!-- <div *ngIf="!(field.name == 'Phone Number')"> -->
                                            <div
                                                *ngIf="!(field.name == 'Phone Number' ||  field.name == 'PhoneNo' || field.name == 'PhoneNo*'  || field.name == 'Phone No')">
                                                <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                                    required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable">
                                            </div>
                                        </span>
                                        <span
                                        *ngIf="field.fld_Enable_Search==true && field.isUsed==true && myStudentFiledTrueFalse && !teacherFiledTrueFalse">
                                        <div
                                            *ngIf="field.name === 'Student Id' || field.name === 'Student Name' || field.name === 'Grade'">
                                            <div style="font-size:11px !important; margin-top:5px;">
                                                <span style="padding-left:10px; ">{{field.name}}</span>
                                            </div>
                                            <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                                style="user-select: none !important;">
                                        </div>
                                    </span>
                                    <span
                                        *ngIf="field.fld_Enable_Search==true && field.isUsed==true && teacherFiledTrueFalse && !myStudentFiledTrueFalse">
                                        <div
                                            *ngIf="field.name === 'Teacher Code' || field.name === 'Teacher Name' || field.name === 'Registered Mobile Number'">
                                            <div style="font-size:11px !important; margin-top:5px;">
                                                <span style="padding-left:10px; ">{{field.name}}</span>
                                            </div>
                                            <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                                style="user-select: none !important;">
                                        </div>
                                    </span>
                                        <span *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true ">
                                            <ng-container *ngIf="!hideDropDownEnableDIsable">
                                                <div *ngIf="field.name === 'School Code'">
                                                    <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                        required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstParentValue($event,field)" (onChange)="firstParentValue($event,field)"
                                                        [filter]="true" filterBy="label">
                                                    </p-dropdown> -->
                                                    <p-dropdown 
                                                    [options]="selctedSchoolCode" 
                                                    [(ngModel)]="schoolCodeValue" 
                                                    placeholder="Select" 
                                                [editable]="true"
                                                    [ngModelOptions]="{standalone: true}"
                                                    [filter]="true" filterBy="sclCode"  (onFilter)="customFilterFunction($event)" (onClear)="ocClearData($event)"
                                                    optionLabel="sclCode" (onSelect)="checkValueAfterClick($event)" (onChange)="checkValueAfterClick($event)">
                                                    <ng-template pTemplate="selectedItem" let-selectedUser>
                                                        <div class="selectedUser-item">
                                                            <div>{{selectedUser.sclCode}}</div>
                                                        </div>
                                                    </ng-template></p-dropdown>
                                                </div>
                                                <ng-container>
                                                    <div *ngIf="field.name === 'School Name'">
                                                        <input type="text"   class="p-inputtext-sm" pInputText [(ngModel)]="schoolNameValue" [ngModelOptions]="{standalone: true}"/>
                                                    </div>
                                                    <div *ngIf="field.name === 'District'">
                                                        <input type="text"   class="p-inputtext-sm" pInputText [(ngModel)]="districtValue" [ngModelOptions]="{standalone: true}"/>
                                                    </div>
                                                    <div *ngIf="field.name === 'Block Name'">
                                                        <input type="text"   class="p-inputtext-sm" pInputText [(ngModel)]="blockNameValue" [ngModelOptions]="{standalone: true}"/>
                                                    </div>
                                                  </ng-container>
                                         
                                            </ng-container>
                                           <ng-container *ngIf="hideDropDownEnableDIsable && field.name != 'Designation' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)' &&  field.name != 'Bot Name'">
                                            <input type="text" pInputText [formControlName]="field.fld_FieldName" 
                                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                            style="user-select: none !important;"   >
                                         <span (click)="returnDropDownFirst" *ngIf="field.name === 'School Code'" style="    position: relative; 
                                         float: right;
                                         bottom: 43px;
                                         left: 6px;">
                                            <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownFirst()" sty></i>
                                         </span>
                                           </ng-container>
                                           <ng-container *ngIf="hidePropertyValueEnable && field.name != 'Designation'   &&  field.name != 'Bot Name' && field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name'">
                                            <input type="text" pInputText [formControlName]="field.fld_FieldName" 
                                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                            style="user-select: none !important;"   >
                                         <span  (click)="returnDropDownSecond" *ngIf="field.name === 'Problem Reported'" style="    position: relative;
                                         float: right;
                                         bottom: 43px;
                                         left: 6px;">
                                            <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownSecond()"></i>
                                         </span>
                                           </ng-container>
                                           <div *ngIf="field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)'">
                                            <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"   (onSelect)="getingBotNameValue($event,field)"
                                            (onChange)="getingBotNameValue($event,field)"
                                                class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                required="field.required" placeholder="select" [readonly]="!field.isEditable" 
                                                [filter]="true" filterBy="label">
                                            </p-dropdown>
                                        </div>
                                        <ng-container *ngIf="!hidePropertyValueEnable">
                                            <div *ngIf="field.name === 'Problem Reported'">
                                                <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstProblemDropDownValue($event,field)" (onChange)="firstProblemDropDownValue($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown> -->
                                                <p-dropdown [options]="getValueParakhBot" [(ngModel)]="problemReportedValue"
                                                [ngModelOptions]="{standalone: true}" optionLabel="value" optionValue="value" class="p-inputtext-sm"
                                                placeholder="Select" (onSelect)="firstProblemDropDownValue($event,field)"
                                                (onChange)="firstProblemDropDownValue($event,field)" [filter]="true"
                                                filterBy="value">
                                                <ng-template pTemplate="selectedItem" let-selectedUser>
                                                    <div class="selectedUser-item" style="width: 100px !important;">
                                                        <div>{{selectedUser.value}}</div>
                                                    </div>
                                                </ng-template>
                                            </p-dropdown>
                                            </div>
                                            <div *ngIf="field.name === 'Problem Category' && mainProblemDropDownValue">
                                                <p-dropdown [options]="ProblemCategoryArr" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable" (onSelect)="ProblemCategoryVFun($event,field)" (onChange)="ProblemCategoryVFun($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown>
                                            </div>
                                            <div *ngIf="field.name === 'Problem Category' && !mainProblemDropDownValue">
                                                <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable" (onSelect)="ProblemCategoryVFun($event,field)" (onChange)="ProblemCategoryVFun($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown>
                                            </div>
                                            <div *ngIf="field.name === 'Dependent upon (State/CG)' && mainNewVariableCheckDepenedent">
                                                <p-dropdown [options]="dependentVariavbles" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable" (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown>
                                            </div>
                                            <div *ngIf="field.name === 'Dependent upon (State/CG)' && !mainNewVariableCheckDepenedent">
                                                <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable" (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown>
                                            </div>
                                        </ng-container>
                                     
                                        </span>
                
                                        <span *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                                                    required="field.required" [readonly]="!field.isEditable">
                                                </p-checkbox>
                                            </div>
                                        </span>
                
                                        <span *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <p-radioButton [formControlName]="field.fld_FieldName" required="field.required"
                                                    [readonly]="!field.isEditable">
                                                </p-radioButton>
                                            </div>
                                        </span>
                
                                        <span *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <p-listbox [formControlName]="field.fld_FieldName" optionLabel="name"
                                                    required="field.required" [readonly]="!field.isEditable"></p-listbox>
                                            </div>
                                        </span>
                
                                        <span *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <textarea pInputTextarea [formControlName]="field.fld_FieldName"
                                                    required="field.required" [readonly]="!field.isEditable"></textarea>
                                            </div>
                                        </span>
                
                                        <span *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <p-multiSelect [options]="cities" class="p-inputtext-sm" optionLabel="name"
                                                    required="field.required" [formControlName]="field.fld_FieldName"
                                                    placeholder="select" [readonly]="!field.isEditable"></p-multiSelect>
                                            </div>
                                        </span>
                                    </div>
                                </ng-container>
                            </div>
                            <!-- <div class="field col-12 md:col-5 flex">
                                <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
                                <div style="margin: 0 5px;"></div>
                                <p-button label="Open DM Chat" (click)="dmChat()" [hidden]="!liveDM"></p-button>
                            </div> -->
                        </div>
                    </div>
                </form>
                    </div>
                </div>
        </div>
            <div class="cardTicket" *ngIf="showTicketCard">

                <!-- assign by && Ticket Status -->
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-2 md:mb-0 cls-new-css-find">Assigned By:<span style="color:red">*</span></div>
                    <div class="col-12 mb-0 md:col-3 md:mb-0">
                        <input type="text" pInputText [(ngModel)]="selectedAssignedBy" readonly="true"
                            class="p-inputtext-sm" />
                    </div>

                    <div class="col-12 mb-0 md:col-2 md:mb-0 cls-new-css-find">Ticket Status<span style="color:red">*</span></div>
                    <div class="col-12 mb-0 md:col-3 md:mb-0">
                        <p-dropdown class="p-inputtext-sm" id="ticketStatus" [options]="ticketStatusDropdownData"
                            [disabled]="disabledTicketFields" [filter]="true" filterBy="label" optionLabel="label"
                            optionValue="value" [(ngModel)]="selectedticketStatus" [showClear]="true"
                            placeholder="Select" (onClick)="getTicketStatus()">
                            <ng-template let-selectedType pTemplate="item">
                                <div class="selectedType-item">
                                    <div>{{selectedType.label}}</div>
                                </div>
                            </ng-template>
                        </p-dropdown>
                    </div>
                </div>
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-2 md:mb-0 cls-new-css-find">Ticket Type:<span style="color:red">*</span></div>

                    <!-- 1st Dropdown -->
                    <div class="col-12 mb-0 md:col-3 md:mb-0" *ngFor="let item of arrObj; let i = index">
                        <p-dropdown class="p-inputtext-sm" id="ticketType[i]" [options]="ticketTypeDropdownData[i]"
                            [disabled]="disabledTicketFields" appendTo="body" [filter]="true" filterBy="label"
                            optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType[i] "
                            [showClear]="true" placeholder="Select" (onChange)="ticketTypeDropdown(i)">
                            <ng-template let-selectedType pTemplate="item">
                                <div class="selectedType-item">
                                    <div>{{selectedType.label}}</div>
                                </div>
                            </ng-template>
                        </p-dropdown>
                    </div>

                </div>


                <!-- tree -->
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-12 md:mb-0 cls-new-css-find">Tree : {{tree}}</div>

                </div>

                <!-- voice file -->
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
                    *ngIf="voicefile">
                    <div class="col-12 mb-0 md:col-2 md:mb-0 cls-new-css-find">Voice File:</div>
                    <div class="col-12 mb-0 md:col-6 md:mb-0">
                        <audio controls>
                            <source [src]="voicefile" type="audio/wav">
                        </audio>
                    </div>
                </div>
            </div>

            <div class="cardTicket" *ngIf="showTicketCard">
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-2 md:mb-0 cls-new-css-find">Agent Remarks:</div>
                    <div class="col-12 mb-0 md:col-6 md:mb-0">
                        <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea
                            [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
                    </div>
                </div>
            </div>


            <div class="cardTicket" *ngIf="showTicketCard">
                <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;padding-bottom: 11px;">

                    <!-- <div class="col-12 mb-0 md:col-2 md:mb-0">
                        <button (click)="callHistory()" pButton pRipple type="button" label="Ticket History" >
                        </button>
                    </div> -->
                    <div class="col-12 mb-0 md:col-2 md:mb-0">
                        <button pButton pRipple type="submit"  label="Save" (click)="saveDynamicLeadCustField()"
                            *ngIf="showSaveButton">
                        </button>

                        <button pButton (click)="updateTiecket()" pButton pRipple  type="Update" label="Update"
                            *ngIf="showUpdateButton">
                        </button>

                    </div>
                </div>
            </div>

        </div>

      

    </div>
</div>
<!-- ticketing dashboard end-->

    <div style="margin: 10px 15px;">
        <p-button (click)="post()">Post</p-button>
    </div>
</div>
<!-- ticket Data -->
<p-dialog position="center" [(visible)]="historyDialogBox" [style]="{width: '85vw'}" header="Ticket History"
[modal]="true" styleClass="p-fluid">
<div *ngFor="let ticketHistory of ticketTypeHistory">
    <div class="cardTicket" style="background-color:rgb(3, 83, 136);">
        <ul style="display: flex; color:white; margin-top:0rem; margin-bottom:0rem; padding-left:0.5rem;    font-size: 14px;">
            <li>TicketNo: {{ticketHistory.ticketID}}</li>
            <span style="margin-left:40px;"></span>
            <li>Source: {{ticketHistory.sourceName}}</li>
            <span style="margin-left:40px;"></span>
            <li>Campaign: {{ticketHistory.campName}}</li>
            <span style="margin-left:40px;"></span>
            <li>ActionNo: {{ticketHistory.action_No}}</li>
            <span style="margin-left:40px;"></span>
            <li>Ticket Time: {{ticketHistory.ticket_Time}}</li>
            <span style="margin-left:40px;"></span>
            <li>Duration: {{ticketHistory.ticketTime}}</li>
        </ul>

    </div>
    <div class="cardTicket">

        <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Start Time<span style="color:red">*</span> :</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.start_Time" readonly="true"
                    class="p-inputtext-sm" />
            </div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket End Time<span style="color:red">*</span> :</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.ticketElapsedTime" readonly="true"
                    class="p-inputtext-sm" />
            </div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">Duration<span style="color:red">*</span> :</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.ticketTime" readonly="true"
                    class="p-inputtext-sm" />
            </div>
        </div>

        <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type<span style="color:red">*</span>:</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.ticket_type_name" readonly="true"
                    class="p-inputtext-sm" />
            </div>


            <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Status<span style="color:red">*</span></div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.ticket_StatusName" readonly="true"
                    class="p-inputtext-sm" />
            </div>


            <div class="col-12 mb-0 md:col-2 md:mb-0">Assigned By<span style="color:red">*</span>:</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.assignedByID" readonly="true"
                    class="p-inputtext-sm" />
            </div>
        </div>


        <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0">UpdateBy<span style="color:red">*</span>:</div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
                <input type="text" pInputText [(ngModel)]="ticketHistory.updatedByID" readonly="true"
                    class="p-inputtext-sm" />
            </div>

            <div class="col-12 mb-0 md:col-2 md:mb-0">Tree :</div>
            <div class="col-12 mb-0 md:col-6 md:mb-0">

            </div>
        </div>

        <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
            *ngIf="ticketHistory.voicefile">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Voice File:</div>
            <div class="col-12 mb-0 md:col-6 md:mb-0">
                <audio controls>
                    <source [src]="ticketHistory.voicefile" type="audio/wav">
                </audio>
            </div>
        </div>

        <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
            <div class="col-12 mb-0 md:col-6 md:mb-0">
                <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea
                    [disabled]="disabledTicketFields" placeholder=" "
                    [(ngModel)]="ticketHistory.remarks"></textarea>
            </div>
        </div>

        <!-- <form [formGroup]="ticketHistoryForm" *ngIf="ticketHistory.objticketDynaField"> -->
        <div *ngIf="ticketHistory.objticketDynaField">
            <div class="dynamic-form-card">
                <div class="p-fluid formgrid grid" style="padding-left: 10px !important; margin-top:10px;">

                    <ng-container *ngFor="let field of ticketHistory.objticketDynaField | keyvalue">
                        <div *ngIf="field.value.fld_isNewRow==true"
                            style="min-inline-size: -webkit-fill-available !important;">
                        </div>
                        <div class="field col-12 md:col-12" *ngIf="field.value.isSeparator==true">
                            {{field.value.separatorText}}</div>
                        <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2">
                            <span>{{field.value.name}}</span>
                        </div>
                        <div class="field col-12 md:col-2">
                            <span
                                *ngIf="field.value.controlType.value == 0 && field.value.displayInClient==true && field.value.isUsed==true && field.value.isUsed==true || 
                                    field.value.controlType.value == 2 && field.value.displayInClient==true && field.value.isUsed==true || field.value.controlType.value == 7 && field.value.displayInClient==true && field.value.isUsed==true ||
                                    field.value.controlType.value == 5 && field.value.displayInClient==true && field.value.isUsed==true">

                                <div *ngIf="field.value.name === 'Phone Number'">
                                    <input type="text" pInputText required="field.value.required"
                                        class="p-inputtext-sm" [(ngModel)]="field.value.value" readonly="true">
                                </div>
                                <div *ngIf="!(field.value.name == 'Phone Number')">
                                    <input type="text" pInputText required="field.value.required"
                                        class="p-inputtext-sm" [(ngModel)]="field.value.value" readonly="true">
                                </div>

                            </span>

                            <span *ngIf="field.value.controlType.value == 8">
                                <div *ngFor="let category of field.value.selectItems" class="field-checkbox">
                                    <p-checkbox name="group" [value]="category.value"
                                        [(ngModel)]="field.value.value" readonly="true"></p-checkbox>
                                    <label [for]="category.key">{{ category.label }}</label>
                                </div>
                                <!-- {{category.value |json}} -->
                            </span>
                            <span
                                *ngIf="field.value.controlType.value == 3 && field.value.displayInClient==true && field.value.isUsed==true">
                                <div>
                                    <!-- {{field.value.value|json}} -->
                                    <p-checkbox binary="true" inputId="binary" required="field.value.required"
                                        [ngModel]="field.value.value === 'true'" readonly="true">
                                    </p-checkbox>
                                </div>
                            </span>

                            <span *ngIf="field.value.controlType.value == 4">
                                <div *ngFor="let radioOption of field.value.selectItems">
                                    <p-radioButton inputId="{{ radioOption.value }}" value="{{ radioOption.value }}"
                                        [(ngModel)]="field.value.value" disabled="true"></p-radioButton>
                                    <label class="ml-2">{{ radioOption.label }}</label>
                                </div>
                            </span>

                            <!-- <span *ngIf="field.value.controlType.value == 7 && field.value.displayInClient==true && field.value.isUsed==true">
                                    <div>
                                        <p-calendar optionLabel="name"
                                            required="field.value.required"></p-calendar>
                                    </div>
                                </span> -->

                            <span
                                *ngIf="field.value.controlType.value == 1 && field.value.displayInClient==true && field.value.isUsed==true">
                                <div>
                                    <textarea pInputTextarea required="field.value.required"
                                        [(ngModel)]="field.value.value" readonly="true"></textarea>
                                </div>
                            </span>
                        </div>

                    </ng-container>
                </div>
            </div>
        </div>
        <!-- </form> -->
    </div>
    <div style="margin-top:10px;"></div>
</div>
</p-dialog>

<p-dialog position="center" [(visible)]="historyDialogBoxFormWithoutTicketing" [style]="{width: '85vw'}" header="Call History"
[modal]="true" styleClass="p-fluid">
<p-table [value]="callHistoryTableData" [resizableColumns]="true" columnResizeMode="expand"
    [tableStyle]="{'max-width': '60rem'}">
    <ng-template pTemplate="header">
        <tr>
            <th *ngIf="enableCallHistoryCRM"></th>
           
            <th pResizableColumn="campName" pSortableColumn="campName" style="width: 3.2px;">CampaignName
            </th>
            <th pResizableColumn="leadSet" pSortableColumn="leadSet" style="width:3.2px;">LeadSet
            </th>
            <th pResizableColumn="agentID" pSortableColumn="agentID" style="width:3.2px;">AgentNo
            </th>
            <th pResizableColumn="phoneNo" pSortableColumn="phoneNo" style="width:3.2px;">PhoneNo
            </th>
            <th pResizableColumn="callTime" pSortableColumn="callTime" style="width:3.2px;">CallTime
            </th>
            <th pResizableColumn="disposition" pSortableColumn="disposition" style="width:3.2px;">Disposition
            </th>
            <th pResizableColumn="solutionProvided" pSortableColumn="solutionProvided" style="width:3.2px;">
                SolnProvided
            </th>
            <th pResizableColumn="customerFeedBack" pSortableColumn="customerFeedBack" style="width:3.2px;">
                CustFeedBack
            </th>
            <th pResizableColumn="currentStatus" pSortableColumn="currentStatus" style="width:3.2px;">CurrStatus
            </th>
            <th pResizableColumn="thirdPartyCallID" pSortableColumn="thirdPartyCallID" style="width:3.2px;">
                3rdPartyID
            </th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
        <tr>
            <td *ngIf="enableCallHistoryCRM"><i class="pi pi-eye" style="font-size: 1rem"
                    (click)="openNonVoiceCustForm()"></i></td>
                    
            <td>{{product.campName}} </td>
            <td>{{product.leadSet}}</td>
            <td>{{product.agentID}} </td>
            <td>{{product.phoneNo}} </td>
            <td>{{product.callTime}}</td>
            <td>{{product.disposition}} </td>
            <td>{{product.solutionProvided}} </td>
            <td>{{product.customerFeedBack}}</td>
            <td>{{product.currentStatus}} </td>
            <td>{{product.thirdPartyCallID}}</td>
        </tr>
    </ng-template>
</p-table>
</p-dialog>