<p-toast></p-toast>
<div class="flex flex-column h-full">
    <div class="flex align-items-center border-bottom-1 surface-border p-3 lg:p-6" *ngIf="parentValue" [ngStyle]="!sideBarMange ? {'width': '30%'} : {'width': '100%'}"
        style="padding: 3px 4px !important; background-color: #ebeef2 !important;">
        <span (click)="manageSideBar()" style="cursor: pointer;">
          <i class="pi pi-bars" style="color: #035388;
          font-weight: 600;
          font-size: 20px;"></i>
        </span>
        <div class="relative flex align-items-center mr-3" style="    margin-left: 20px;">
            <img src="assets/images/user.png" alt="user" class="w-2rem h-2rem border-circle shadow-4">

        </div>
        <div class="mr-2">
            <span class="text-900 font-semibold block" style="color: black !important;">{{parentValue?.phoneNo}}</span>
            <span (click)="RedialNumber()" class="whastappIcon" style="    height: 24px;
    width: 24px;"  tooltipPosition="bottom" pTooltip="Make Call">
            <i class="material-icons" style="    color: #fff;
  position: relative;
  left: 5px;
  top: 3px;font-size: 12px !important;">add_ic_call</i>
          </span>
        </div>
        <div class="flex align-items-center " style="    justify-content: end;
        width: 100%;
        position: relative;
        right: 40px;">
        <div class="mr-1 addMobileCls" *ngIf="showFaqDetails" (click)="getFaqDetails()">
          <a rel="noopener noreferrer" class="inatagCss">
            <button pButton label="FAQ's" class="w-full sm:w-auto" [raised]="true" 
              style="padding: 6px; font-size: 12px;     border-radius: 100px; background: #0ea5e9 !important;
  border: 1px solid #0ea5e9 !important;">
            </button>
          </a>
        </div>
        <!-- <div class="mr-1 addMobileCls" *ngIf="contactSharing">
          <button pButton label="Send Contact" class="w-full sm:w-auto" (click)="sendBusinessContact()" [raised]="true"
            tooltipPosition="bottom" pTooltip="Send Business Contact" style="    padding: 6px;
              font-size: 12px;
                  border-radius: 100px;    background: #f97316 !important;
              border: 1px solid #f97316  !important;
          "></button>
        </div>
        <div class="mr-1 addMobileCls" *ngIf="smsApi">
          <button pButton label="Send Invite" class="w-full sm:w-auto" (click)="sendInviteApi($event)" [raised]="true"
            tooltipPosition="bottom" pTooltip="Send Invitation On SMS" style="    padding: 6px;
              font-size: 12px;
                  border-radius: 100px;    background: #a855f7 !important;
              border: 1px solid #a855f7 !important;
          "></button>
        </div> -->
                <span>
                  <i class="pi pi-ellipsis-h" style="margin-left: 5px; cursor: pointer;"
                    (click)="opTop.toggle($event);"></i>
                </span>
        </div>
    </div>
    <div class="chat-messages" [ngStyle]="!sideBarMange ? {'display': 'flex'} : {'display': 'block'}">
      <div style="height: calc(100% - 48px);"  [ngStyle]="!sideBarMange ? {'width': '30%'} : {'width': '100%'}">

    <div class="p-3 md:px-4 lg:px-6 lg:py-4  overflow-y-auto" style="height: 100%;" #chatWindow>


        <div *ngFor="let item of messages">

            <div class="grid grid-nogutter mb-0">
                <div class="col mt-1" *ngIf="item.type == 'CUSTOMER' && item.phoneNo === parentValue.phoneNo">
                        <div style="display: flex;" class="">
                            <!-- <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3-bg.webp"
                              alt="avatar 1" style="width: 45px; height: 45px;"> -->
                            <ng-container >
                              <div class="" role="row">
                                <div tabindex="-1" class="_amjv _aotl" data-id="true_919582062028@c.us_3EB0E448B6D1E58F88AEBA">
                                  <div class="message-out focusable-list-item _amjy _amjz _amjw"><span class=""></span>
                                    <div class="_amk4 _amkd">
                                      <div class="_amk6 _amlo newColorBack"><span aria-label="You:"></span>
                                        <div>
                                          <div class="x9f619 x1hx0egp x1yrsyyn x1ct7el4 x1dm7udd xwib8y2">
                                            <div class="copyable-text" data-pre-plain-text="[11:49 am, 4/5/2024] €€: ">
                                              <div class="_ahy0"  *ngIf="item?.isReply"  >
                                                <div class="_aju2" *ngIf="item.replyMedia == 'Text'"  >
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"  
                                                            style="min-height: 0px;">{{item.replyText}}</span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'png' || item?.replyMedia == 'jpeg' || item?.replyMedia == 'jpg' || item?.replyMedia == 'apng' || item?.replyMedia == 'svg' || item?.replyMedia == 'bmp' || item?.replyMedia == 'gif'  || item?.replyMedia == 'webp' || item?.replyMedia == 'jfif'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">{{item.replyText}}</span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <div class="_agtm">
                                                      <div class="_agtn">
                                                        <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48">
                                                        <a [href]="item?.replyText" target="_blank" rel="noopener noreferrer">
                                                        <img [src]="item.replyText" style="width: 80px;height:80px;" alt="">
                                                        </a>
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'mp3' || item?.replyMedia == 'wav' || item?.replyMedia == 'ogg'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            <audio controls>
                                                              <source [src]="item?.replyText">
                                                              Your browser does not support the audio element.
                                                            </audio></span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'avi' || item?.replyMedia == 'mov' || item?.replyMedia == 'mp4' || item?.replyMedia == 'webm' || item?.replyMedia == 'wmv'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            <video width="260" height="160" controls>
                                                              <source [src]="item?.replyText">
                                                              Your browser does not support the video tag.
                                                            </video>
                                                          </span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'doc' || item?.replyMedia == 'docs'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            {{item.replyText}}
                                                          </span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <div class="_agtm">
                                                      <div class="_agtn">
                                                        <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                        [style.background-image]="'url(assets/images/word-icon.jpg)'">
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'xlsx' || item?.replyMedia == 'csv'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            {{item.replyText}}
                                                          </span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <div class="_agtm">
                                                      <div class="_agtn">
                                                        <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                        [style.background-image]="'url(assets/images/excel-icon.png)'">
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>

                                                <div class="_aju2" *ngIf="item?.replyMedia == 'pdf'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            {{item.replyText}}
                                                          </span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <div class="_agtm">
                                                      <div class="_agtn">
                                                        <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                        [style.background-image]="'url(assets/images/pdf-icon.jpg)'">
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="_aju2" *ngIf="item?.replyMedia == 'Location'">
                                                  <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                                    tabindex="0"><span class="x6wgc6a _aju7"></span>
                                                    <div class="_aju8" >
                                                      <div class="_ajua">
                                                        <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                            class="_ao3e" style="min-height: 0px;">{{parentValue?.phoneNo}}</span></div>
                                                        <div class="_ak3u" dir="ltr" role="button">
                                                          <span dir="auto"
                                                            aria-label="" class="quoted-mention _ao3e"
                                                            style="min-height: 0px;">
                                                            {{item.replyText}}
                                                          </span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <div class="_agtm">
                                                      <div class="_agtn" (click)="onSelectMaps(item)">
                                                        <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                        [style.background-image]="'url(assets/images/map.jpg)'">
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>


                                              </div>
                                              <div class="_akbu">
                                                <span dir="ltr" aria-label="" *ngIf="item?.mediaType == 'Text'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;">
                                                  <span [innerHTML]="item.message | linkifyurl">{{item?.message}}</span>
                                                </span>
                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'png' || item?.mediaType == 'jpeg' || item?.mediaType == 'jpg' || item?.mediaType == 'apng' || item?.mediaType == 'svg' || item?.mediaType == 'bmp' || item?.mediaType == 'gif'  || item?.mediaType == 'webp' || item?.mediaType == 'jfif'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                    <img [src]="item?.message" width="200" height="200">
                                                    </a>
                                                  </span></span>
                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'mp3' || item?.mediaType == 'wav' || item?.mediaType == 'ogg'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <audio controls>
                                                      <source [src]="item?.message">
                                                      Your browser does not support the audio element.
                                                    </audio>
                                                  </span></span>
                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'doc' || item?.mediaType == 'docs'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                      <img src="assets/images/word-icon.jpg" style="width: 80px;height:80px;" alt="">
                                                    </a>
                                                  </span></span>
                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'xlsx' || item?.mediaType == 'csv'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                      <img src="assets/images/excel-icon.png" style="width: 80px;height:80px;" alt="">
                                                    </a>
                                                  </span></span>

                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'pdf' "
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                      <img src="assets/images/pdf-icon.jpg" style="width: 80px;height:80px;" alt="">
                                                    </a>
                                                  </span></span>
                                                <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'Location' "
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <a  target="_blank" rel="noopener noreferrer" (click)="onSelectMaps(item)">
                                                      <img src="assets/images/map.jpg" style="    width: 100%;
    height: 100%;" alt="">
                                                    </a>
                                                  </span></span>
                                                  <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'Contacts' "
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <!-- <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                      <img src="assets/images/pdf-icon.jpg" style="width: 80px;height:80px;" alt="">
                                                    </a> -->
                                                    <span class="repliedtext1" 
                                                    style="margin-left: -17px;cursor: pointer;" (click)="myContactDetails(item)">
                                                    <a >
                                                      <span style="display: flex;">
                                                        <i class="pi pi-user" style="font-size: 1.5rem;
                                                      border: 2px solid #000;
                                                      color: #000;
                                                      padding: 5px;
                                                      border-radius: 50%;"></i>
                                                        <nav style="color: #000 !important;
                                                       padding-top: 8px;
                                                       padding-left: 10px;">{{item.contactName}}</nav>
                                                      </span>
                                                      <br>
                                                      <nav style="color: #000 !important;">{{item.message}}</nav>
                                                    </a>
                                                  </span>
                                                  </span></span>

                                                <span dir="ltr" aria-label=""   *ngIf="item?.mediaType == 'avi' || item?.mediaType == 'mov' || item?.mediaType == 'mp4' || item?.mediaType == 'webm' || item?.mediaType == 'wmv'"
                                                  class="_ao3e selectable-text copyable-text"
                                                  style="min-height: 0px;"><span>
                                                    <video width="260" height="160" controls>
        
                                                      <source [src]="item?.message">
                                                      Your browser does not support the video tag.
                                                    </video>
                                                  </span></span>
                                                  <span class="">
                                                    <span
                                                    class="x3nfvp2 xxymvpz xlshs6z xqtp20y xexx8yu x150jy0e x18d9i69 x1e558r4 x12lo8hy x152skdk"
                                                    aria-hidden="true"><span class="x1c4vz4f x2lah0s xn6xy2s"></span><span
                                                      class="x1c4vz4f x2lah0s">{{item?.currentTime}}</span></span></span></div>
                                            </div>
                                            <div class="x1n2onr6 x1n327nk x18mqm2i xhsvlbd x11i5rnm xz62fqu xsgj6o6">
                                              <div class="x13yyeie xx3o462 xuxw1ft x78zum5 x6s0dn4 x12lo8hy x152skdk"
                                                role="button"><span class="x1rg5ohu x16dsc37" dir="auto">{{item?.currentTime}}</span>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="_amlr"></div>
                                      </div>
                                      <span  (click)="callHistoryNew(item.ticketId)" class="addViewTicket"
                                      *ngIf="item.ticket">View Ticket</span>
                                      <div
                                        class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 x78zum5 xozqiw3 x1oa3qoh x12fk4p8 xeuugli x2lwn1j x13a6bvl x1q0g3np x6s0dn4 _amj_">
                                        <div
                                          class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 xeuugli x2lwn1j xozqiw3 x1oa3qoh x12fk4p8 xlrawln xexx8yu x10ogl3i x18d9i69 x1k2j06m">
                                          <div></div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="x78zum5 x1n2onr6 xbfrwjf x8k05lb xeq5yr9 x4r51d9 xpvyfi4"></div>
                                  </div>
                                </div>
                              </div>
                           
                            </ng-container>
                            <i class="pi pi-ellipsis-h" style="margin-left: 8px; cursor: pointer;"
                            (click)="op.toggle($event); sendData(item)"></i>
                          </div>
                </div>
            </div>


            <div class="grid grid-nogutter mb-0" style="    display: flex;
            justify-content: end;">
                <!-- <ng-template  style="background-color: #fff;"> -->

                <div class="col mt-1 text-right" style="    display: flex;
                justify-content: end;" *ngIf="item.type == 'AGENT'">
                    <i class="pi pi-ellipsis-h" style="margin-right: 5px; cursor: pointer;"
                        (click)="op.toggle($event); sendData(item)"></i>
                <div style="display: inline-grid;" class="">
                    <ng-container >
                        <div class="" role="row">
                          <div tabindex="-1" class="_amjv _aotl" data-id="true_919582062028@c.us_3EB0E448B6D1E58F88AEBA">
                            <div class="message-out focusable-list-item _amjy _amjz _amjw"><span class=""></span>
                              <div class="_amk4 _amkd">
                                <div class="_amk6 _amlo"><span aria-label="You:"></span>
                                  <div>
                                    <div class="x9f619 x1hx0egp x1yrsyyn x1ct7el4 x1dm7udd xwib8y2">
                                      <div class="copyable-text" data-pre-plain-text="[11:49 am, 4/5/2024] €€: ">
                                        <div class="_ahy0"  *ngIf="item?.isReply"  >
                                          <div class="_aju2" *ngIf="item.replyMedia == 'Text'"  >
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e" 
                                                      style="min-height: 0px;">{{item.replyText}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="_aju2" *ngIf="item?.replyMedia == 'png' || item?.replyMedia == 'jpeg' || item?.replyMedia == 'jpg' || item?.replyMedia == 'apng' || item?.replyMedia == 'svg' || item?.replyMedia == 'bmp' || item?.replyMedia == 'gif'  || item?.replyMedia == 'webp' || item?.replyMedia == 'jfif'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">{{item.replyText}}</span>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="_agtm">
                                                <div class="_agtn">
                                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48" >
                                                    <a [href]="item?.replyText" target="_blank" rel="noopener noreferrer">
                                                  <img [src]="item.replyText" style="width: 80px;height:80px;" alt="">
                                                    </a>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="_aju2" *ngIf="item?.replyMedia == 'mp3' || item?.replyMedia == 'wav' || item?.replyMedia == 'ogg'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      <audio controls>
                                                        <source [src]="item?.replyText">
                                                        Your browser does not support the audio element.
                                                      </audio></span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="_aju2" *ngIf="item?.replyMedia == 'avi' || item?.replyMedia == 'mov' || item?.replyMedia == 'mp4' || item?.replyMedia == 'webm' || item?.replyMedia == 'wmv'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      <video width="260" height="160" controls>
                                                        <source [src]="item?.replyText">
                                                        Your browser does not support the video tag.
                                                      </video>
                                                    </span>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>


                                          <div class="_aju2" *ngIf="item?.replyMedia == 'doc' || item?.replyMedia == 'docs'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      {{item.replyText}}
                                                    </span>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="_agtm">
                                                <div class="_agtn">
                                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                  [style.background-image]="'url(assets/images/word-icon.jpg)'">
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="_aju2" *ngIf="item?.replyMedia == 'Location'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      {{item.replyText}}
                                                    </span>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="_agtm">
                                                <div class="_agtn" (click)="onSelectMaps(item)">
                                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                  [style.background-image]="'url(assets/images/map.jpg)'">
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>


                                          <div class="_aju2" *ngIf="item?.replyMedia == 'xlsx' || item?.replyMedia == 'csv'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      {{item.replyText}}
                                                    </span>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="_agtm">
                                                <div class="_agtn">
                                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                  [style.background-image]="'url(assets/images/excel-icon.png)'">
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class="_aju2" *ngIf="item?.replyMedia == 'pdf'">
                                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                                              <div class="_aju8" >
                                                <div class="_ajua">
                                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                                  <div class="_ak3u" dir="ltr" role="button">
                                                    <span dir="auto"
                                                      aria-label="" class="quoted-mention _ao3e"
                                                      style="min-height: 0px;">
                                                      {{item.replyText}}
                                                    </span>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="_agtm">
                                                <div class="_agtn">
                                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                                  [style.background-image]="'url(assets/images/pdf-icon.jpg)'">
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="_akbu" style="text-align: left;">
                                          <span dir="ltr" aria-label="" *ngIf="item?.mediaType == 'Text'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span [innerHTML]="item.message | linkifyurl">{{item?.message}}</span></span>
                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'png' || item?.mediaType == 'jpeg' || item?.mediaType == 'jpg' || item?.mediaType == 'apng' || item?.mediaType == 'svg' || item?.mediaType == 'bmp' || item?.mediaType == 'gif'  || item?.mediaType == 'webp' || item?.mediaType == 'jfif'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                              <img [src]="item?.message" width="200" height="200">
                                              </a>
                                            </span></span>
                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'mp3' || item?.mediaType == 'wav' || item?.mediaType == 'ogg'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <audio controls>
                                                <source [src]="item?.message">
                                                Your browser does not support the audio element.
                                              </audio>
                                            </span></span>
                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'doc' || item?.mediaType == 'docs'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                <img src="assets/images/word-icon.jpg" style="width: 80px;height:80px;" alt="">
                                              </a>
                                            </span></span>
                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'xlsx' || item?.mediaType == 'csv'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                <img src="assets/images/excel-icon.png" style="width: 80px;height:80px;" alt="">
                                              </a>
                                            </span></span>

                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'pdf' "
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                <img src="assets/images/pdf-icon.jpg" style="width: 80px;height:80px;" alt="">
                                              </a>
                                            </span></span>
                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'Contacts' "
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <!-- <a [href]="item?.message" target="_blank" rel="noopener noreferrer">
                                                <img src="assets/images/pdf-icon.jpg" style="width: 80px;height:80px;" alt="">
                                              </a> -->
                                              <span class="repliedtext1" 
                                              style="margin-left: -17px;cursor: pointer;" (click)="myContactDetails(item)">
                                              <a >
                                                <span style="display: flex;">
                                                  <i class="pi pi-user" style="font-size: 1.5rem;
                                                border: 2px solid #000;
                                                color: #000;
                                                padding: 5px;
                                                border-radius: 50%;"></i>
                                                  <nav style="color: #000 !important;
                                                 padding-top: 8px;
                                                 padding-left: 10px;">{{item.contactName}}</nav>
                                                </span>
                                                <br>
                                                <nav style="color: #000 !important;">{{item.message}}</nav>
                                              </a>
                                            </span>
                                            </span></span>

                                          <span dir="ltr" aria-label=""  *ngIf="item?.mediaType == 'Location' "
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <a  target="_blank" rel="noopener noreferrer" (click)="onSelectMaps(item)">
                                                <img src="assets/images/map.jpg" style="    width: 100%;
    height: 100%;" alt="">
                                              </a>
                                            </span></span>


                                          <span dir="ltr" aria-label=""   *ngIf="item?.mediaType == 'avi' || item?.mediaType == 'mov' || item?.mediaType == 'mp4' || item?.mediaType == 'webm' || item?.mediaType == 'wmv'"
                                            class="_ao3e selectable-text copyable-text"
                                            style="min-height: 0px;"><span>
                                              <video width="260" height="160" controls>
  
                                                <source [src]="item?.message">
                                                Your browser does not support the video tag.
                                              </video>
                                            </span></span>
                                            <span class="">
                                              <span
                                              class="x3nfvp2 xxymvpz xlshs6z xqtp20y xexx8yu x150jy0e x18d9i69 x1e558r4 x12lo8hy x152skdk"
                                              aria-hidden="true"><span class="x1c4vz4f x2lah0s xn6xy2s"></span><span
                                                class="x1c4vz4f x2lah0s">{{item?.currentTime}}</span></span></span></div>
                                      </div>
                                      <div class="x1n2onr6 x1n327nk x18mqm2i xhsvlbd x11i5rnm xz62fqu xsgj6o6">
                                        <div class="x13yyeie xx3o462 xuxw1ft x78zum5 x6s0dn4 x12lo8hy x152skdk"
                                          role="button"><span class="x1rg5ohu x16dsc37" dir="auto">{{item?.currentTime}}</span>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="_amlr"></div>
                                </div>
                                <span (click)="callHistoryNew(item.ticketId)" class="addViewTicket"
                                *ngIf="item.ticket">View Ticket</span>
                                <div
                                  class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 x78zum5 xozqiw3 x1oa3qoh x12fk4p8 xeuugli x2lwn1j x13a6bvl x1q0g3np x6s0dn4 _amj_">
                                  <div
                                    class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 xeuugli x2lwn1j xozqiw3 x1oa3qoh x12fk4p8 xlrawln xexx8yu x10ogl3i x18d9i69 x1k2j06m">
                                    <div></div>
                                  </div>
                                </div>
                              </div>
                              <div class="x78zum5 x1n2onr6 xbfrwjf x8k05lb xeq5yr9 x4r51d9 xpvyfi4"></div>
                            </div>
                          </div>
                        </div>
  
                      </ng-container>
                 </div>

                    <!-- <p class="text-700 mt-1" style="color: black !important;">{{item?.currentTime}}</p> -->
                </div>
                <!-- </ng-template> -->
            </div>
        </div>
    </div>
    <ng-container *ngIf="!sideBarMange">
 <!-- update -->
 <ng-container *ngIf="repliedMsg">
  <div class="main-div-data">
    <div class="replayData">
      <div class="headingg">
       
        <div class="" role="row">
          <div tabindex="-1" class="_amjv _aotl" data-id="true_919582062028@c.us_3EB0E448B6D1E58F88AEBA">
            <div class=" focusable-list-item _amjy _amjz _amjw" style="padding-left: 0px;"><span class=""></span>
              <div class="_amk4 _amkd">
                <div class="_amk6 _amlo"><span aria-label="You:"></span>
                  <div>
                    <div class="x9f619 x1hx0egp x1yrsyyn x1ct7el4 x1dm7udd xwib8y2 newcssAdd">
                      <div class="copyable-text newStateSet" data-pre-plain-text="[11:49 am, 4/5/2024] €€: ">
                        <div class="_ahy0">
                          <div class="_aju2" *ngIf="repliedMsg.mediaType == 'Text'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button"><span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">{{repliedMsg.message}}</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'png' || repliedMsg?.mediaType == 'jpeg' || repliedMsg?.mediaType == 'jpg' || repliedMsg?.mediaType == 'apng' || repliedMsg?.mediaType == 'svg' || repliedMsg?.mediaType == 'bmp' || repliedMsg?.mediaType == 'gif'  || repliedMsg?.mediaType == 'webp' || repliedMsg?.mediaType == 'jfif'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">{{repliedMsg.message}}</span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm" style="    margin-left: 67px;">
                                <div class="_agtn" style="    width: 100%;">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48">
                                    <a [href]="repliedMsg?.message" target="_blank" rel="noopener noreferrer">
                                  <img [src]="repliedMsg.message" style="width: 120px;height:80px;" alt="">
                                    </a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'mp3' || repliedMsg?.mediaType == 'wav' || repliedMsg?.mediaType == 'ogg'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" style="width: 100% !important;">
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                   {{repliedMsg?.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm" >
                                <div class="_agtn" style="width: 100% !important;">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                 >
                                 <audio controls style="height: 100px;">
                                  <source [src]="repliedMsg?.message">
                                  Your browser does not support the audio element.
                                </audio>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'avi' || repliedMsg?.mediaType == 'mov' || repliedMsg?.mediaType == 'mp4' || repliedMsg?.mediaType == 'webm' || repliedMsg?.mediaType == 'wmv'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" style="    width: 100% !important;">
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                     {{repliedMsg?.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm">
                                <div class="_agtn" style="width: 100% !important;">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                 >
                                 <video  height="100" controls>
                                  <source [src]="repliedMsg?.message">
                                  Your browser does not support the video tag.
                                </video>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'doc' || repliedMsg?.mediaType == 'docs'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                      {{repliedMsg.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm">
                                <div class="_agtn">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                  [style.background-image]="'url(assets/images/word-icon.jpg)'">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'xlsx' || repliedMsg?.mediaType == 'csv'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                      {{repliedMsg.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm">
                                <div class="_agtn">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                  [style.background-image]="'url(assets/images/excel-icon.png)'">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'pdf'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                      {{repliedMsg.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm">
                                <div class="_agtn">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                  [style.background-image]="'url(assets/images/pdf-icon.jpg)'">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'Location'">
                            <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                              tabindex="0"><span class="x6wgc6a _aju7"></span>
                              <div class="_aju8" >
                                <div class="_ajua">
                                  <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                      class="_ao3e" style="min-height: 0px;">You</span></div>
                                  <div class="_ak3u" dir="ltr" role="button">
                                    <span dir="auto"
                                      aria-label="" class="quoted-mention _ao3e"
                                      style="min-height: 0px;">
                                      {{repliedMsg.message}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                              <div class="_agtm">
                                <div class="_agtn" (click)="onSelectMaps(repliedMsg)">
                                  <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                  [style.background-image]="'url(assets/images/map.jpg)'">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                    
                      </div>
                    
                    </div>
                  </div><span class=""></span>
                  <div class="_amlr"></div>
                </div>
                <div
                  class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 x78zum5 xozqiw3 x1oa3qoh x12fk4p8 xeuugli x2lwn1j x13a6bvl x1q0g3np x6s0dn4 _amj_">
                  <div
                    class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 xeuugli x2lwn1j xozqiw3 x1oa3qoh x12fk4p8 xlrawln xexx8yu x10ogl3i x18d9i69 x1k2j06m">
                    <div></div>
                  </div>
                </div>
              </div>
              <div class="x78zum5 x1n2onr6 xbfrwjf x8k05lb xeq5yr9 x4r51d9 xpvyfi4"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="close" (click)="closeReply()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
        style="height: 30px; width: 30px; color: red; cursor: pointer" (click)="closeReply()">
        <path
          d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z">
        </path>
      </svg>
    </div>
  </div>


</ng-container>
  <!-- main div -->
  <div style="display: flex;justify-content: center;">
    <ng-container *ngIf="showSuggestions">
      <p-listbox  
      [options]="templateDropdown" 
      optionLabel="templateName" 
      [style]="{'width':'45rem'}" 
      [multiple]="false" 
      optionValue="templateMsg" 
      [(ngModel)]="selectedTemp"
      (onChange)="checkTemplate($event)"
      [metaKeySelection]="false" 
      [listStyle]="{'max-height': '220px'}" ></p-listbox>
    </ng-container>
   </div>

  <div class="p-3 md:p-4 lg:p-3 flex flex-column sm:flex-row align-items-center mt-auto border-top-1 surface-border gap-3"
      style="background-color: #ebeef2 !important;" *ngIf="parentValue">
      <!-- <div class="flex w-full sm:w-auto gap-3">
         
          <p-fileUpload #fileUpload mode="basic" chooseLabel="Choose" [multiple]="true" [maxFileSize]="50000000"
              (onSelect)="onUpload($event)" (onClear)="onUpload($event)" (onRemove)="onUpload($event)"
              [showCancelButton]="false" chooseLabel="Files" class="custom-file-upload">
              <ng-template #defaultTemplate let-files>
                  <ul *ngIf="files.length">
                      <li *ngFor="let file of files">{{file.name}}</li>
                  </ul>
              </ng-template>
          </p-fileUpload>
          
          &nbsp;&nbsp;&nbsp;
      </div> -->
      <ng-container>
        <!-- <button pButton pRipple style="background-color: #128C7E; border-color: #128C7E;"> -->
          <audio *ngIf="newRecordValue" controls>
            <source [src]="setMyFIleAudio" type="audio/mp3">
          </audio>
        <!-- </button> -->

        <div *ngIf="newRecordValue" >
          <span  style="border-radius: 50%;
            padding: 4px 4px 2px 4px;
            background: red;
            cursor: pointer;" (click)="clearRecordedData()">
            <i  class="pi pi-times" style="color: #fff"></i>
          </span>
        </div>
      </ng-container>
      <span style="border-radius: 50%;
      padding: 4px 4px 2px 4px;
      cursor: pointer;
      margin-right: 20px;
      height: 39px;
      width: 41px;" (click)="bottomData.toggle($event)">
        <i class="pi pi-paperclip" style="    color: #1089be;
      position: relative;
      left: 4px;
      top: 3px;
      font-size: 27px;"></i>

      </span>
      <!-- <div class="flex w-full sm:w-auto gap-3">
           
        <p-fileUpload #fileUpload mode="basic" chooseLabel="Choose" [multiple]="true" [maxFileSize]="50000000"
            (onSelect)="onUpload($event)" (onClear)="onUpload($event)" (onRemove)="onUpload($event)"
            [showCancelButton]="false" chooseLabel="Files" class="custom-file-upload">
            <ng-template #defaultTemplate let-files>
                <ul *ngIf="files.length">
                    <li *ngFor="let file of files">{{file.name}}</li>
                </ul>
            </ng-template>
        </p-fileUpload>
        
        &nbsp;&nbsp;&nbsp;
    </div> -->
    <!-- uncomment code -->
      <!-- <div class="flex w-full sm:w-auto gap-3">
        <p-dropdown class="p-dropdown1" [options]="templateDropdown" [(ngModel)]="selectedTemp"  [filter]="true"
            optionLabel="templateName" optionValue="templateMsg" [showClear]="true" placeholder="Templates"
            (onSelect)="checkTemplate($event)" (onChange)="checkTemplate($event)"></p-dropdown>
    </div> -->
      <input id="message" type="text" pInputText placeholder="Type a message"
          class="flex-1 w-full sm:w-auto border-round" [(ngModel)]="message" autofocus (input)="newFunction()"
          [disabled]="myAudioVariableTrueFalse" (keydown.enter)="send()" />
      &nbsp; &nbsp;
      <div class="flex w-full sm:w-auto gap-3">

          <button pButton pRipple label="Send"  [disabled]="!message" class="w-full sm:w-auto" (click)="send()"></button>
          &nbsp;
      </div>
      <div class="flex w-full sm:w-auto gap-3" >
        <button pButton pRipple icon="pi pi-microphone" class="w-full sm:w-auto" style="height: 41px;    width: 3rem !important;
" *ngIf="!isRecording && !blobUrl" (click)="startRecording()">

          <i class="material-symbols-outlined">
            mic
            </i>
        </button> &nbsp;
        <div *ngIf="isRecording && !blobUrl" style="    position: relative;
        bottom: 17px;
        left: 36px;"> {{recordedTime}} </div>
      
        <button pButton pRipple icon="pi pi-stop-circle " class="w-full sm:w-auto" style="width: 3rem !important;" *ngIf="isRecording && !blobUrl" (click)="stopRecording()"></button> &nbsp;
        &nbsp;
      </div>
  </div>
    </ng-container>
      </div>
      
      <!-- ticketing dashboard start -->
      <div class="card p-fluid formgrid grid overflow-y-auto" style="    padding: 10px;
      height: calc(100% - -70px);
      margin-top: 0px !important;
      width: 100%;
      margin: auto;
      border-radius: unset;
      position: relative;
      bottom: 49px;    padding-left: 0px;" *ngIf="newTicketFlag">
        <div class="col-12 md:col-12 " style="    border-radius: unset;    padding-left: 0px;">
          <!-- <i class="pi pi-times-circle" (click)="closeDetailsTicket()" style="font-size: 2rem;
  float: right;
  position: relative;cursor: pointer;
  left: 18px;
  bottom: 7px;"></i> -->
          <div class="cardTicket dispositioncard2">

            <div class="cardTicket" style="background-color: #128c7e;
            height: 33px;
            display: flex;
            align-items: center;
            text-align: center;" *ngIf="showTicketCard">
              <ul style="display: flex; color:white; margin-top:0rem; margin-bottom:0rem; padding-left:0.5rem;font-size: 10px;">
                <li>Ticket Id: {{ticketNo}}</li>
                <span style="margin-left:40px;"></span>
                <li>Source: {{sourceName}}</li>
                <span style="margin-left:40px;"></span>
                <li>Campaign: {{ticketCampaignName}}</li>
                <span style="margin-left:40px;"></span>
                <li>ActionNo: {{actionNo}}</li>
                <span style="margin-left:40px;"></span>
                <li>Ticket Time: {{ticketTime}}</li>
                <span style="margin-left:40px;"></span>
                <li>Duration: {{ticketDuration}}</li>
              </ul>
              <span class="exitTicketValue"  (click)="closeDetailsTicket()">Exit Ticket</span>
            </div>
            <div class="cardTicket" *ngIf="showTicketCard">
              <form [formGroup]="customForm">
                <div>
                  <div class=" dynamic-form-card" style="    margin-top: 7px;
    border-bottom: 1px dotted;">
                    <div class="p-fluid formgrid grid">
                      <ng-container *ngFor="let field of formFields">
                        <div *ngIf="field.fld_isNewRow==true"
                          style="min-inline-size: -webkit-fill-available !important;">
                        </div>
                        <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">{{field.separatorText}}
                        </div>
                        <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2"
                          *ngIf="field.fld_Enable_Search==false">
                          <span style="padding-left:10px; ">{{field.name}}</span>
                        </div>
                        <div class="field col-12 md:col-2">
                          <span
                            *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true && field.fld_Enable_Search==false">
                            <div
                              *ngIf="field.name == 'Phone Number' || field.name == 'PhoneNo' || field.name == 'PhoneNo*' || field.name == 'Phone No'">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName" *ngIf="!isMasked"
                                required="field.required" class="p-inputtext-sm" style=" user-select: none !important;">

                              <input type="text" pInputText id="phoneInput" *ngIf="isMasked" required="field.required"
                                class="p-inputtext-sm" style=" user-select: none !important;">

                            </div>

                            <!-- <div *ngIf="!(field.name == 'Phone Number')"> -->
                            <div
                              *ngIf="!(field.name == 'Phone Number' ||  field.name == 'PhoneNo' || field.name == 'PhoneNo*'  || field.name == 'Phone No')">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable">
                            </div>
                          </span>
                          <span
                            *ngIf="field.fld_Enable_Search==true && field.isUsed==true && myStudentFiledTrueFalse && !teacherFiledTrueFalse">
                            <div
                              *ngIf="field.name === 'Student Id' || field.name === 'Student Name' || field.name === 'Grade'">
                              <div style="font-size:11px !important; margin-top:5px;">
                                <span style="padding-left:10px; ">{{field.name}}</span>
                              </div>
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                style="user-select: none !important;">
                            </div>
                          </span>
                          <span
                            *ngIf="field.fld_Enable_Search==true && field.isUsed==true && teacherFiledTrueFalse && !myStudentFiledTrueFalse">
                            <div
                              *ngIf="field.name === 'Teacher Code' || field.name === 'Teacher Name' || field.name === 'Registered Mobile Number'">
                              <div style="font-size:11px !important; margin-top:5px;">
                                <span style="padding-left:10px; ">{{field.name}}</span>
                              </div>
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                style="user-select: none !important;">
                            </div>
                          </span>
                          <span
                            *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true ">
                            <ng-container *ngIf="!hideDropDownEnableDIsable">
                              <div *ngIf="field.name === 'School Code'">
                                <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                    class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                    required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstParentValue($event,field)" (onChange)="firstParentValue($event,field)"
                                                    [filter]="true" filterBy="label">
                                                </p-dropdown> -->
                                <p-dropdown [options]="selctedSchoolCode" [(ngModel)]="schoolCodeValue"
                                  placeholder="Select" [editable]="true" [ngModelOptions]="{standalone: true}"
                                  [filter]="true" filterBy="sclCode" (onFilter)="customFilterFunction($event)"
                                  (onClear)="ocClearData($event)" optionLabel="sclCode"
                                  (onSelect)="checkValueAfterClick($event)" (onChange)="checkValueAfterClick($event)">
                                  <ng-template pTemplate="selectedItem" let-selectedUser>
                                    <div class="selectedUser-item">
                                      <div>{{selectedUser.sclCode}}</div>
                                    </div>
                                  </ng-template></p-dropdown>
                              </div>
                              <ng-container>
                                <div *ngIf="field.name === 'School Name'">
                                  <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="schoolNameValue"
                                    [ngModelOptions]="{standalone: true}" />
                                </div>
                                <div *ngIf="field.name === 'District'">
                                  <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="districtValue"
                                    [ngModelOptions]="{standalone: true}" />
                                </div>
                                <div *ngIf="field.name === 'Block Name'">
                                  <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="blockNameValue"
                                    [ngModelOptions]="{standalone: true}" />
                                </div>
                              </ng-container>

                            </ng-container>
                            <ng-container
                              *ngIf="hideDropDownEnableDIsable && field.name != 'Designation' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)' &&  field.name != 'Bot Name'">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                style="user-select: none !important;">
                              <span (click)="returnDropDownFirst" *ngIf="field.name === 'School Code'" style="    position: relative; 
                                     float: right;
                                     bottom: 43px;
                                     left: 6px;">
                                <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownFirst()"
                                  sty></i>
                              </span>
                            </ng-container>
                            <ng-container
                              *ngIf="hidePropertyValueEnable && field.name != 'Designation'   &&  field.name != 'Bot Name' && field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name'">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                style="user-select: none !important;">
                              <span (click)="returnDropDownSecond" *ngIf="field.name === 'Problem Reported'" style="    position: relative;
                                     float: right;
                                     bottom: 43px;
                                     left: 6px;">
                                <i class="pi pi-times-circle" style="font-size: 20px"
                                  (click)="returnDropDownSecond()"></i>
                              </span>
                            </ng-container>
                            <div
                              *ngIf="field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)'">
                              <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                (onSelect)="getingBotNameValue($event,field)"
                                (onChange)="getingBotNameValue($event,field)" class="p-inputtext-sm"
                                [formControlName]="field.fld_FieldName" required="field.required" placeholder="select"
                                [readonly]="!field.isEditable" [filter]="true" filterBy="label">
                              </p-dropdown>
                            </div>
                            <ng-container *ngIf="!hidePropertyValueEnable">
                              <div *ngIf="field.name === 'Problem Reported'">
                                <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstProblemDropDownValue($event,field)" (onChange)="firstProblemDropDownValue($event,field)"
                                                [filter]="true" filterBy="label">
                                            </p-dropdown> -->
                                <p-dropdown [options]="getValueParakhBot" [(ngModel)]="problemReportedValue"
                                  [ngModelOptions]="{standalone: true}" optionLabel="value" optionValue="value"
                                  class="p-inputtext-sm" placeholder="Select"
                                  (onSelect)="firstProblemDropDownValue($event,field)"
                                  (onChange)="firstProblemDropDownValue($event,field)" [filter]="true" filterBy="value">
                                  <ng-template pTemplate="selectedItem" let-selectedUser>
                                    <div class="selectedUser-item" style="width: 100px !important;">
                                      <div>{{selectedUser.value}}</div>
                                    </div>
                                  </ng-template>
                                </p-dropdown>
                              </div>
                              <div *ngIf="field.name === 'Problem Category' && mainProblemDropDownValue">
                                <p-dropdown [options]="ProblemCategoryArr" optionlabel="label" optionValue="value"
                                  class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                  required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                  (onSelect)="ProblemCategoryVFun($event,field)"
                                  (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                                </p-dropdown>
                              </div>
                              <div *ngIf="field.name === 'Problem Category' && !mainProblemDropDownValue">
                                <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                  class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                  required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                  (onSelect)="ProblemCategoryVFun($event,field)"
                                  (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                                </p-dropdown>
                              </div>
                              <div *ngIf="field.name === 'Dependent upon (State/CG)' && mainNewVariableCheckDepenedent">
                                <p-dropdown [options]="dependentVariavbles" optionlabel="label" optionValue="value"
                                  class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                  required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                  (onSelect)="DependentuponFunc($event,field)"
                                  (onChange)="DependentuponFunc($event,field)" [filter]="true" filterBy="label">
                                </p-dropdown>
                              </div>
                              <div
                                *ngIf="field.name === 'Dependent upon (State/CG)' && !mainNewVariableCheckDepenedent">
                                <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                  class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                  required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                  (onSelect)="DependentuponFunc($event,field)"
                                  (onChange)="DependentuponFunc($event,field)" [filter]="true" filterBy="label">
                                </p-dropdown>
                              </div>
                            </ng-container>

                          </span>

                          <span
                            *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                                required="field.required" [readonly]="!field.isEditable">
                              </p-checkbox>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-radioButton [formControlName]="field.fld_FieldName" required="field.required"
                                [readonly]="!field.isEditable">
                              </p-radioButton>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-listbox [formControlName]="field.fld_FieldName" optionLabel="name"
                                required="field.required" [readonly]="!field.isEditable"></p-listbox>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <textarea pInputTextarea [formControlName]="field.fld_FieldName" required="field.required"
                                [readonly]="!field.isEditable"></textarea>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-multiSelect [options]="cities" class="p-inputtext-sm" optionLabel="name"
                                required="field.required" [formControlName]="field.fld_FieldName" placeholder="select"
                                [readonly]="!field.isEditable"></p-multiSelect>
                            </div>
                          </span>
                        </div>
                      </ng-container>
                    </div>
                    <!-- <div class="field col-12 md:col-5 flex">
                            <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
                            <div style="margin: 0 5px;"></div>
                            <p-button label="Open DM Chat" (click)="dmChat()" [hidden]="!liveDM"></p-button>
                        </div> -->
                  </div>
                </div>
              </form>
              <!-- assign by && Ticket Status -->
              <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                <div class="col-12 mb-0 md:col-2 md:mb-0" style="font-size: 11px;">Assigned By:<span style="color:red">*</span></div>
                <div class="col-12 mb-0 md:col-3 md:mb-0">
                  <input type="text" pInputText [(ngModel)]="selectedAssignedBy" readonly="true"
                    class="p-inputtext-sm" />
                </div>

                <div class="col-12 mb-0 md:col-2 md:mb-0" style="font-size: 11px;">Ticket Status<span style="color:red">*</span></div>
                <div class="col-12 mb-0 md:col-3 md:mb-0">
                  <p-dropdown class="p-inputtext-sm" id="ticketStatus" [options]="ticketStatusDropdownData"
                    [disabled]="disabledTicketFields" [filter]="true" filterBy="label" optionLabel="label"
                    optionValue="value" [(ngModel)]="selectedticketStatus" [showClear]="true" placeholder="Select"
                    (onClick)="getTicketStatus()">
                    <ng-template let-selectedType pTemplate="item">
                      <div class="selectedType-item">
                        <div>{{selectedType.label}}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                </div>
              </div>

              <!-- ticket type -->
              <!-- <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type:<span style="color:red">*</span></div>
                    <div class="col-12 mb-0 md:col-3 md:mb-0">
                        <i class="pi pi-chevron-circle-left" style="font-size: 1.7rem"
                            (click)="previousIconTicketType()"></i>
                        <p-dropdown class="p-inputtext-sm" id="ticketType" [options]="ticketTypeDropdownData"
                            appendTo="body" [disabled]="disabledTicketFields" [filter]="true" filterBy="label"
                            optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType" [showClear]="true"
                            placeholder="Select ">
                            <ng-template let-selectedType pTemplate="item">
                                <div class="selectedType-item">
                                    <div>{{selectedType.label}}</div>
                                </div>
                            </ng-template>
                        </p-dropdown>
                        <i class="pi pi-chevron-circle-right" style="font-size: 1.7rem"
                            (click)="forwardIconTicketType()"></i>
                    </div>
                </div> -->

              <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                <div class="col-12 mb-0 md:col-2 md:mb-0 " style="font-size: 11px;">Ticket Type:<span style="color:red">*</span></div>

                <!-- 1st Dropdown -->
                <div class="col-12 mb-0 md:col-3 md:mb-0" *ngFor="let item of arrObj; let i = index">
                  <p-dropdown class="p-inputtext-sm" id="ticketType[i]" [options]="ticketTypeDropdownData[i]"
                    [disabled]="disabledTicketFields" appendTo="body" [filter]="true" filterBy="label"
                    optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType[i] " [showClear]="true"
                    placeholder="Select" (onChange)="ticketTypeDropdown(i)">
                    <ng-template let-selectedType pTemplate="item">
                      <div class="selectedType-item">
                        <div>{{selectedType.label}}</div>
                      </div>
                    </ng-template>
                  </p-dropdown>
                </div>

              </div>


              <!-- tree -->
              <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                <div class="col-12 mb-0 md:col-12 md:mb-0" style="font-size: 11px;">Tree : {{tree}}</div>

              </div>

              <!-- voice file -->
              <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
                *ngIf="voicefile">
                <div class="col-12 mb-0 md:col-2 md:mb-0" style="font-size: 11px;">Voice File:</div>
                <div class="col-12 mb-0 md:col-6 md:mb-0">
                  <audio controls>
                    <source [src]="voicefile" type="audio/wav">
                  </audio>
                </div>
              </div>

              <!-- agent remarks && moved to below just above the callback section -->
              <!-- <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                    <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
                    <div class="col-12 mb-0 md:col-6 md:mb-0">
                        <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea
                            [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
                    </div>
                </div> -->
            </div>

            <div class="cardTicket" *ngIf="showDynaTicketCard">
              <form [formGroup]="ticketForm">
                <div>
                  <div class="dynamic-form-card">
                    <div class="p-fluid formgrid grid" style="padding-left: 10px !important; margin-top:10px;">
                      <ng-container *ngFor="let field of ticketFields">
                        <div *ngIf="field.fld_isNewRow==true"
                          style="min-inline-size: -webkit-fill-available !important;">
                        </div>
                        <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">
                          <div class="flex flex-wrap">
                            <span>{{field.separatorText}}</span>
                            <span class="remaining-space"></span>
                          </div>
                        </div>
                        <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2">
                          <span>{{field.name}}</span>
                        </div>
                        <div class="field col-12 md:col-2">
                          <span
                            *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true">
                            <div *ngIf="field.name === 'Phone Number'">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm">
                            </div>

                            <div *ngIf="!(field.name == 'Phone Number')">
                              <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                required="field.required" class="p-inputtext-sm">
                            </div>

                          </span>

                          <span
                            *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                            <div>

                              <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                                required="field.required">
                              </p-checkbox>
                            </div>

                          </span>

                          <span
                            *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                            <div *ngFor="let radioOption of field.selectItems">
                              <p-radioButton binary="true" inputId="binary" [value]="radioOption.value"
                                [formControlName]="field.fld_FieldName"></p-radioButton>
                              <label class="ml-2">{{ radioOption.label }}</label>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 7 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-calendar [formControlName]="field.fld_FieldName" optionLabel="name"
                                required="field.required"></p-calendar>
                            </div>
                          </span>

                          <span
                            *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <textarea pInputTextarea [formControlName]="field.fld_FieldName"
                                required="field.required"></textarea>
                            </div>
                          </span>

                          <!-- <span
                                            *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                                            <div>
                                                <p-multiSelect [options]="field.selectItems" class="p-inputtext-sm"
                                                    optionLabel="label" optionValue="value" required="field.required"
                                                    [formControlName]="field.fld_FieldName"
                                                    defaultLabel="Select a City"></p-multiSelect>
                                            </div>
                                        </span> -->
                          <span
                            *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-multiSelect [options]="field.selectItems" class="p-inputtext-sm" optionLabel="label"
                                optionValue="value" [formControlName]="field.fld_FieldName"
                                defaultLabel="Select Value"></p-multiSelect>
                            </div>

                          </span>

                          <!-- <span
                                        *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                                        <div *ngFor="let category of field.selectItems" class="field-checkbox">
                                            <p-checkbox name="group" [value]="category.value" [formControlName]="field.fld_FieldName" [inputId]="category.key"></p-checkbox>
                                            <label [for]="category.key">{{ category.label }}</label>
                                        </div>
                                        </span> -->

                          <span
                            *ngIf="field.controlType.value == 8 && field.displayInClient == true && field.isUsed == true">
                            <div *ngFor="let category of field.selectItems" class="field-checkbox">
                              <p-checkbox name="group" [value]="category.value" [(ngModel)]="abc"
                                [formControlName]="field.fld_FieldName" [inputId]="category.key"></p-checkbox>
                              <label [for]="category.key">{{ category.label }}</label>

                            </div>
                            <!-- {{category.value |json}} -->
                          </span>


                          <span
                            *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true">
                            <div>
                              <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                                placeholder="select" [filter]="true" filterBy="label">
                              </p-dropdown>
                            </div>
                          </span>
                        </div>

                      </ng-container>
                    </div>
                  </div>
                </div>
              </form>

            </div>

            <div class="cardTicket" *ngIf="showTicketCard">
              <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                <div class="col-12 mb-0 md:col-2 md:mb-0" style="font-size: 11px;">Agent Remarks:</div>
                <div class="col-12 mb-0 md:col-6 md:mb-0">
                  <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea class="p-inputtext"
                    [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
                </div>
              </div>
            </div>


            <div class="cardTicket" *ngIf="showTicketCard">
              <div class="grid forms-grid flex-row p-fluid"
                style="padding-left: 10px !important; margin-top:10px;padding-bottom: 11px;">

                <!-- <div class="col-12 mb-0 md:col-1 md:mb-0">
                  <div>Ticket Id</div>
                </div>
                <div class="col-12 mb-0 md:col-2 md:mb-0">
                  <div><input class="p-inputtext-sm" type="text" pInputText [(ngModel)]="ticketNo" /></div>
                </div> -->

                <div class="col-12 mb-0 md:col-3 md:mb-0" *ngIf="getUdatedDialogData">
                  <button (click)="callHistory()" pButton pRipple type="button" label="Ticket History"
                    style="background: #128c7e;    white-space: pre;
    width: 100%;">
                  </button>
                </div>
                <div class="col-12 mb-0 md:col-2 md:mb-0">
                  <button pButton pRipple type="submit" style="background: #128c7e;" label="Save"
                    (click)="saveDynamicLeadCustField()" *ngIf="showSaveButton">
                  </button>
                  <!-- <button pButton pRipple type="submit" style="background: #128c7e;" label="Save" (click)="saveTicketData()"
                            *ngIf="showSaveButton">
                        </button> -->

                  <button pButton (click)="updateTiecket()" pButton pRipple style="background: #128c7e;" type="Update"
                    label="Update" *ngIf="showUpdateButton">
                  </button>
                </div>
              </div>
            </div>
          </div>



        </div>
      </div>
     
      <div class="p-fluid formgrid grid overflow-y-auto card" style="padding: 10px;
      width: 100%;
      margin: auto;
      height: calc(100% - -68px);
      margin-top: 0px !important;
      position: relative;
      bottom: 48px;
      border-radius: unset;"
        *ngIf="ticketHistoryValueOpen">
        <div class="col-12 md:col-12">
          <!-- <i class="pi pi-times-circle" (click)="closeDetailsTicketNew()" style="font-size: 2rem;z-index: 4;
  float: right;
  position: relative;cursor: pointer;
  left: 18px;
  bottom: 7px;"></i> -->
          <p-table #dt1 [value]="ticketRecordsValueComman" styleClass="p-datatable-gridlines" selectionMode="single"
            scrollHeight="350px" [(selection)]="selecteddata" dataKey="code" [metaKeySelection]="true"
            responsiveLayout="scroll" [paginator]="true" [rowsPerPageOptions]="[10,15,30,50,75,  { showAll: 'All' }]"
            [rows]="10" [showCurrentPageReport]="true" responsiveLayout="scroll"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [globalFilterFields]="['ticketID', 'campName']">
            <ng-template pTemplate="caption">
              <div class="flex">
                <p-button label="Clear" icon="pi pi-filter-slash" (click)="clear(dt1)"></p-button>
                <span class="p-input-icon-left ml-auto" style="width: 20%;">
                  <i class="pi pi-search"></i>
                  <input pInputText type="text" (input)="dt1.filterGlobal($any($event.target).value, 'contains')"
                    placeholder="Search keyword" />
                </span>
                <p-button label="Exit Ticket" style="margin-left: 4px;" (click)="closeDetailsTicketNew()"></p-button>
                
              </div>
            </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <th>
                  Ticket Id
                </th>
                <th>
                  Source
                </th>
                <th>
                  Campaign

                </th>
                <th>
                  ActionNo
                </th>
                <th>
                  Ticket Time
                </th>
                <th>
                  Duration
                </th>
                <th>
                  Ticket Start Time
                </th>
                <th>
                  Ticket End Time
                </th>
                <th>
                  Ticket Type
                </th>
                <th>
                  Ticket Status
                </th>
                <th>
                  Assigned By
                </th>
                <th>
                  UpdateBy
                </th>
                <!-- <th>
                  Tree
                </th> -->
                <th>
                  Agent Remarks
                </th>
                <th>
                  Update Ticket
                </th>
                <th>
                  Details
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-Dataaa>
              <tr [pSelectableRow]="selectedData" (click)="onRowClick(Dataaa)">
                <td>
                  <span class="p-column-title">CallID </span>
                  {{Dataaa.ticketID}}
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">PhoneNo.</span>
                  <span class="image-text">{{Dataaa.sourceName}}</span>
                </td>

                <td style="font-weight:600; ">
                  <span class="p-column-title">Agnet No.</span>
                  <span class="image-text">{{Dataaa.campName}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Start Time</span>
                  <span class="image-text">{{Dataaa.action_No}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">End Time</span>
                  <span class="image-text">{{Dataaa.ticket_Time}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Talk Time</span>
                  <span class="image-text">{{Dataaa.ticketTime}}</span>
                </td>


                <td style="font-weight:600; ">
                  <span class="p-column-title">Agent Ansd</span>
                  <span class="image-text">{{Dataaa.start_Time}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.ticketElapsedTime}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.ticket_type_name}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.ticket_StatusName}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.assignedByID}}</span>
                </td>
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.updatedByID}}</span>
                </td>
                <!-- <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.ticket_Type_Tree}}</span>
                </td> -->
                <td style="font-weight:600; ">
                  <span class="p-column-title">Customer Ansd</span>
                  <span>{{Dataaa.remarks}}</span>
                </td>
                <td style="font-weight:600; ">

                  <span class="" (click)="ticketOpen(Dataaa)">
                    <i class="pi pi-pencil"></i>
                  </span>
                  <!-- <button (click)="ticketOpen(Dataaa)" pButton pRipple type="button" label="Update" style="background: #128c7e;">
                        </button> -->
                </td>
                <td style="font-weight:600; ">
                  <span class="" (click)="callHistoryOne(Dataaa)">
                    <i class="pi pi-eye"></i>
                  </span>
                  <!-- <button (click)="callHistoryOne(Dataaa.ticketID)" pButton pRipple type="button" label="History" style="background: #128c7e;">
                        </button> -->
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="16">No Record found.</td>
              </tr>
            </ng-template>
            <ng-template pTemplate="paginatorleft">
              <div class="grid-child" style="margin-left: 5px">
                <button type="button" class="change" style="display: none;" label="Export" pButton pRipple
                  icon="pi pi-file-excel" [style]="{'background':'#69a74e ','height':'38px', 'font-size': '11px'}"
                  class="p-button-success mr-2 sceenwidthsize" pTooltip="XLS" tooltipPosition="bottom"></button>
              </div>
            </ng-template>
            <ng-template pTemplate="paginatorright">
              <div class="grid-child" style="margin-left: 5px">
                <button type="button" class="change" label="Export" pButton pRipple icon="pi pi-file-excel"
                  [style]="{'background':' green !important','height':'30px','margin-left':'10px'}"
                  (click)="exportExcel()" class="p-button-success mr-2 sceenwidthsize" pTooltip="XLS"
                  tooltipPosition="bottom"></button>
              </div>
            </ng-template>
          </p-table>
        </div>
      </div>
      <!-- ticket histroy table end -->
      <ng-container *ngIf="sideBarMange">
        <!-- update -->
        <ng-container *ngIf="repliedMsg">
         <div class="main-div-data">
           <div class="replayData">
             <div class="headingg">
              
               <div class="" role="row">
                 <div tabindex="-1" class="_amjv _aotl" data-id="true_919582062028@c.us_3EB0E448B6D1E58F88AEBA">
                   <div class=" focusable-list-item _amjy _amjz _amjw" style="padding-left: 0px;"><span class=""></span>
                     <div class="_amk4 _amkd">
                       <div class="_amk6 _amlo"><span aria-label="You:"></span>
                         <div>
                           <div class="x9f619 x1hx0egp x1yrsyyn x1ct7el4 x1dm7udd xwib8y2 newcssAdd">
                             <div class="copyable-text newStateSet" data-pre-plain-text="[11:49 am, 4/5/2024] €€: ">
                               <div class="_ahy0">
                                 <div class="_aju2" *ngIf="repliedMsg.mediaType == 'Text'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button"><span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">{{repliedMsg.message}}</span>
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'png' || repliedMsg?.mediaType == 'jpeg' || repliedMsg?.mediaType == 'jpg' || repliedMsg?.mediaType == 'apng' || repliedMsg?.mediaType == 'svg' || repliedMsg?.mediaType == 'bmp' || repliedMsg?.mediaType == 'gif'  || repliedMsg?.mediaType == 'webp' || repliedMsg?.mediaType == 'jfif'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">{{repliedMsg.message}}</span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm" style="    margin-left: 67px;">
                                       <div class="_agtn" style="    width: 100%;">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48">
                                           <a [href]="repliedMsg?.message" target="_blank" rel="noopener noreferrer">
                                         <img [src]="repliedMsg.message" style="width: 120px;height:80px;" alt="">
                                           </a>
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'mp3' || repliedMsg?.mediaType == 'wav' || repliedMsg?.mediaType == 'ogg'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" style="width: 100% !important;">
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                          {{repliedMsg?.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm" >
                                       <div class="_agtn" style="width: 100% !important;">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                        >
                                        <audio controls style="height: 100px;">
                                         <source [src]="repliedMsg?.message">
                                         Your browser does not support the audio element.
                                       </audio>
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'avi' || repliedMsg?.mediaType == 'mov' || repliedMsg?.mediaType == 'mp4' || repliedMsg?.mediaType == 'webm' || repliedMsg?.mediaType == 'wmv'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" style="    width: 100% !important;">
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                            {{repliedMsg?.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm">
                                       <div class="_agtn" style="width: 100% !important;">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                        >
                                        <video  height="100" controls>
                                         <source [src]="repliedMsg?.message">
                                         Your browser does not support the video tag.
                                       </video>
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'doc' || repliedMsg?.mediaType == 'docs'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                             {{repliedMsg.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm">
                                       <div class="_agtn">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                         [style.background-image]="'url(assets/images/word-icon.jpg)'">
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'xlsx' || repliedMsg?.mediaType == 'csv'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                             {{repliedMsg.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm">
                                       <div class="_agtn">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                         [style.background-image]="'url(assets/images/excel-icon.png)'">
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
       
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'pdf'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                             {{repliedMsg.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm">
                                       <div class="_agtn">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                         [style.background-image]="'url(assets/images/pdf-icon.jpg)'">
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
                                 <div class="_aju2" *ngIf="repliedMsg?.mediaType == 'Location'">
                                   <div class="_aju6 _aju3" role="button" aria-label="Quoted message"
                                     tabindex="0"><span class="x6wgc6a _aju7"></span>
                                     <div class="_aju8" >
                                       <div class="_ajua">
                                         <div class="_ahxj xijeqtt" role=""><span dir="auto" aria-label=""
                                             class="_ao3e" style="min-height: 0px;">You</span></div>
                                         <div class="_ak3u" dir="ltr" role="button">
                                           <span dir="auto"
                                             aria-label="" class="quoted-mention _ao3e"
                                             style="min-height: 0px;">
                                             {{repliedMsg.message}}
                                           </span>
                                         </div>
                                       </div>
                                     </div>
                                     <div class="_agtm">
                                       <div class="_agtn" (click)="onSelectMaps(repliedMsg)">
                                         <div class="xh8yej3 x5yr21d x1xsqp64 x18d0r48"
                                         [style.background-image]="'url(assets/images/map.jpg)'">
                                         </div>
                                       </div>
                                     </div>
                                   </div>
                                 </div>
       
                               </div>
                           
                             </div>
                           
                           </div>
                         </div><span class=""></span>
                         <div class="_amlr"></div>
                       </div>
                       <div
                         class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 x78zum5 xozqiw3 x1oa3qoh x12fk4p8 xeuugli x2lwn1j x13a6bvl x1q0g3np x6s0dn4 _amj_">
                         <div
                           class="x1c4vz4f xs83m0k xdl72j9 x1g77sc7 xeuugli x2lwn1j xozqiw3 x1oa3qoh x12fk4p8 xlrawln xexx8yu x10ogl3i x18d9i69 x1k2j06m">
                           <div></div>
                         </div>
                       </div>
                     </div>
                     <div class="x78zum5 x1n2onr6 xbfrwjf x8k05lb xeq5yr9 x4r51d9 xpvyfi4"></div>
                   </div>
                 </div>
               </div>
             </div>
           </div>
           <div class="close" (click)="closeReply()">
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
               style="height: 30px; width: 30px; color: red; cursor: pointer" (click)="closeReply()">
               <path
                 d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z">
               </path>
             </svg>
           </div>
         </div>
       
       
       </ng-container>
         <!-- main div -->
         <div style="display: flex;justify-content: center;">
           <ng-container *ngIf="showSuggestions">
             <p-listbox  
             [options]="templateDropdown" 
             optionLabel="templateName" 
             [style]="{'width':'45rem'}" 
             [multiple]="false" 
             optionValue="templateMsg" 
             [(ngModel)]="selectedTemp"
             (onChange)="checkTemplate($event)"
             [metaKeySelection]="false" 
             [listStyle]="{'max-height': '220px'}" ></p-listbox>
           </ng-container>
          </div>
       
         <div class="p-3 md:p-4 lg:p-3 flex flex-column sm:flex-row align-items-center mt-auto border-top-1 surface-border gap-3"
             style="background-color: #ebeef2 !important;" *ngIf="parentValue">
             <!-- <div class="flex w-full sm:w-auto gap-3">
                
                 <p-fileUpload #fileUpload mode="basic" chooseLabel="Choose" [multiple]="true" [maxFileSize]="50000000"
                     (onSelect)="onUpload($event)" (onClear)="onUpload($event)" (onRemove)="onUpload($event)"
                     [showCancelButton]="false" chooseLabel="Files" class="custom-file-upload">
                     <ng-template #defaultTemplate let-files>
                         <ul *ngIf="files.length">
                             <li *ngFor="let file of files">{{file.name}}</li>
                         </ul>
                     </ng-template>
                 </p-fileUpload>
                 
                 &nbsp;&nbsp;&nbsp;
             </div> -->
             <ng-container>
               <!-- <button pButton pRipple style="background-color: #128C7E; border-color: #128C7E;"> -->
                 <audio *ngIf="newRecordValue" controls>
                   <source [src]="setMyFIleAudio" type="audio/mp3">
                 </audio>
               <!-- </button> -->
       
               <div *ngIf="newRecordValue" >
                 <span  style="border-radius: 50%;
                   padding: 4px 4px 2px 4px;
                   background: red;
                   cursor: pointer;" (click)="clearRecordedData()">
                   <i  class="pi pi-times" style="color: #fff"></i>
                 </span>
               </div>
             </ng-container>
             <span style="border-radius: 50%;
             padding: 4px 4px 2px 4px;
             cursor: pointer;
             margin-right: 20px;
             height: 39px;
             width: 41px;" (click)="bottomData.toggle($event)">
               <i class="pi pi-paperclip" style="    color: #1089be;
             position: relative;
             left: 4px;
             top: 3px;
             font-size: 27px;"></i>
       
             </span>
             <div class="flex w-full sm:w-auto gap-3">
               <p-dropdown class="p-dropdown1" [options]="templateDropdown" [(ngModel)]="selectedTemp"  [filter]="true"
                   optionLabel="templateName" optionValue="templateMsg" [showClear]="true" placeholder="Templates"
                   (onSelect)="checkTemplate($event)" (onChange)="checkTemplate($event)"></p-dropdown>
           </div>
             <input id="message" type="text" pInputText placeholder="Type a message"
                 class="flex-1 w-full sm:w-auto border-round" [(ngModel)]="message" autofocus (input)="newFunction()"
                 [disabled]="myAudioVariableTrueFalse" (keydown.enter)="send()" />
             &nbsp; &nbsp;
             <div class="flex w-full sm:w-auto gap-3">
              <!-- <button (click)="notifyMe()">Notify me!</button> -->

                 <button pButton pRipple label="Send"  [disabled]="!message" class="w-full sm:w-auto" (click)="send()"></button>
                 &nbsp;
             </div>
             <div class="flex w-full sm:w-auto gap-3" >
               <button pButton pRipple icon="pi pi-microphone" class="w-full sm:w-auto" style="height: 41px;    width: 3rem !important;
       " *ngIf="!isRecording && !blobUrl" (click)="startRecording()">
       
                 <i class="material-symbols-outlined">
                   mic
                   </i>
               </button> &nbsp;
               <div *ngIf="isRecording && !blobUrl" style="    position: relative;
               bottom: 17px;
               left: 36px;"> {{recordedTime}} </div>
             
               <button pButton pRipple icon="pi pi-stop-circle " class="w-full sm:w-auto" style="width: 3rem !important;" *ngIf="isRecording && !blobUrl" (click)="stopRecording()"></button> &nbsp;
               &nbsp;
             </div>
         </div>
           </ng-container>
    </div>
</div>

<!-- <p-overlayPanel #op styleClass="w-full sm:w-30rem">
    <ng-template pTemplate>
        <button *ngFor="let emoji of emojis;" pButton pRipple (click)="op.hide(); onEmojiSelect(emoji)" type="button" [label]="emoji" class="p-2 p-button-text text-2xl"></button>
    </ng-template>
</p-overlayPanel> -->
<p-overlayPanel #op>
    <ng-template pTemplate="content">

        <div class="align-items-center replySection" (click)="replyMsg(mySendDat);">
            Reply
        </div>
        <br>
        <div class="align-items-center replySection" (click)="forwardMsg(mySendDat)">
            Forward
        </div>
        <br>
        <div class="align-items-center replySection" [hidden]="!ticketEnable" (click)="ticketOpen(mySendDat)">
          Ticket
        </div>
    </ng-template>
</p-overlayPanel>

<p-overlayPanel #opTop>
  <ng-template pTemplate="content">
    <div class="align-items-center replySection" [hidden]="!ticketEnable" (click)="newTicketOpen()">
      New Ticket
    </div>
    <br>
    <div class="align-items-center replySection" (click)="getAllTickets()" [hidden]="!ticketEnable">
    View Ticket
    </div>
    <br>
    <div class="align-items-center replySection"   (click)="sessionClose(parentValue?.phoneNo)">
      End
    </div>
  </ng-template>
</p-overlayPanel>
<!-- dialogs -->
<p-dialog position="top" [(visible)]="newNumberDialog" [style]="{'width': '45vw', 'height': 'auto'}"
  header="Message Forwarding" [modal]="true" [draggable]="false" [resizable]="false">
  <div class="grid forms-grid flex-row p-fluid mt-2" *ngIf="forwardContacts">
    <div class="col-12 mb-0 md:col-4 md:mb-0">Contact List:</div>
    <div class="col-12 mb-0 md:col-8 md:mb-0">
      <p-dropdown [options]="forwardContacts" [(ngModel)]="newNo" placeholder="Select number" [editable]="true"
        (onChange)="onChangeData($event)" optionLabel="phoneNo" appendTo="body" [filter]="true"></p-dropdown>

    </div>
  </div>



  <div class="grid forms-grid flex-row p-fluid">
    <div class="col-12 mb-0 md:col-8 md:mb-0"></div>
    <div class="col-12 mb-0 md:col-4 md:mb-0">
      <button pButton label="Forward" icon="pi pi-send" (click)="sendForward()" style="background: #128C7E !important;
      border: #128C7E !important;"></button>
    </div>
  </div>

</p-dialog>

<p-overlayPanel #bottomData>
  <div class="flex flex-column gap-3 " style="width: 2rem  !important;">
    <div>
      <ul class="list-none p-0 m-0 flex flex-column gap-3">
        <li class="flex align-items-center gap-2" style="margin-bottom: 10px;cursor: pointer;" pTooltip="Location"
          tooltipPosition="right" (click)="getLocation();">
          <img src="assets/images/images/location-logo.jpg" alt="" style="    height: 25px;
    width: 25px;">
        </li>
        <li class="flex align-items-center gap-2" style="margin-top: 3px;cursor: pointer;" pTooltip="Contacts"
          tooltipPosition="right" (click)="sendContactDEatisl()">
          <img src="assets/images/images/new-contact.png" alt="" style="    height: 18px;
          width: 18px;
          margin-left: 3px;">
        </li>
        <li class="flex align-items-center gap-2" style="margin-top: 11px;cursor: pointer;margin-left: 4px;" pTooltip="Upload"
          tooltipPosition="right">
          <p-fileUpload #fileUpload  mode="basic"  [multiple]="true" [maxFileSize]="50000000"
          (onSelect)="onUpload($event)"     chooseIcon="pi pi-upload" 
          [showCancelButton]="true"  class="custom-file-upload">
          <!-- <ng-template #defaultTemplate let-files>
              <ul *ngIf="files.length">
                  <li *ngFor="let file of files">{{file.name}}</li>
              </ul>
          </ng-template> -->
      </p-fileUpload>
          <!-- <label style="display: none;">
            <input hidden id="upload_file" type="file" #file multiple (change)="uploadHandlers(file)">
          </label>
          <input hidden readonly="true" type="text" id="file" (click)="trigger()">
          <i class="pi pi-upload" (click)="trigger()"></i> -->
        </li>
      </ul>
    </div>
  </div>
</p-overlayPanel>
<!-- dialogs -->
<p-dialog position="top" [(visible)]="sendContactSharing" [style]="{'width': '45vw', 'height': 'auto'}"
  header="Contact Sharing" [modal]="true" [draggable]="false" [resizable]="false">
  <div class="grid forms-grid flex-row p-fluid mt-2">
    <div class="col-12 mb-0 md:col-4 md:mb-0">Contact List:</div>
    <div class="col-12 mb-0 md:col-8 md:mb-0">
      <p-dropdown [options]="matchedContacts" [(ngModel)]="newNoSend" placeholder="Select number" [editable]="true"
        (onChange)="onChangeData($event)" optionLabel="phone" appendTo="body" [filter]="true">
        <ng-template let-option pTemplate="item">
          <div class="flex align-items-center">
            <span>{{ option.phone }} ({{ option.name }})</span>
          </div>
        </ng-template></p-dropdown>
      <!-- <p-dropdown [options]="forwardContacts" [(ngModel)]="newNoSend" placeholder="Select number" [editable]="true"
        (onChange)="onChangeData($event)" optionLabel="phoneNumber" appendTo="body" [filter]="true"></p-dropdown> -->

    </div>
  </div>



  <div class="grid forms-grid flex-row p-fluid">
    <div class="col-12 mb-0 md:col-8 md:mb-0"></div>
    <div class="col-12 mb-0 md:col-4 md:mb-0">
      <button pButton label="Send Contact"  (click)="send()" style="background: #128C7E !important;
      border: #128C7E !important;"></button>
    </div>
  </div>

</p-dialog>

<!-- dialogs -->
<p-dialog position="top" [(visible)]="locationVis" [style]="{'width': '45vw', 'height': 'auto'}" header="Location"
  [modal]="true" [draggable]="false" [resizable]="false">
  <div class="grid forms-grid flex-row p-fluid mt-2">
    <div class="col-12 mb-0 md:col-4 md:mb-0">Contact Location:</div>
    <div class="col-12 mb-0 md:col-8 md:mb-0">
      <p-dropdown [options]="myLOcationDataNew" [(ngModel)]="locationV" placeholder="Select number" [editable]="false"
        optionLabel="first_name" appendTo="body" [filter]="true" (onSelect)="checkValueNew($event)"
        (onChange)="checkValueNew($event)">
        <ng-template let-option pTemplate="item">
          <div class="flex align-items-center">
            <span>{{ option.phoneNo }} ({{ option.first_name }})</span>
          </div>
        </ng-template>
      </p-dropdown>
      <!-- <p>
        Latitude : {{fld_Location_Latitude}}
      </p>
      <p>
        Longitude : {{fld_Location_Longitude}}
      </p> -->
    </div>
  </div>



  <div class="grid forms-grid flex-row p-fluid">
    <div class="col-12 mb-0 md:col-8 md:mb-0"></div>
    <div class="col-12 mb-0 md:col-4 md:mb-0">
      <button pButton label="Send Location"  (click)="send()" style="background: #128C7E !important;
      border: #128C7E !important;"></button>
    </div>
  </div>

</p-dialog>


<!-- conatcatsdetails -->

<p-dialog header="Contact Details" [modal]="true" [(visible)]="visibleContacsDetails" [style]="{ width: '30rem' }"
  [breakpoints]="{ '1199px': '40vw', '575px': '90vw' }">

  <ng-container *ngIf="mainContactDetailsArr">
    <p class="mb-5"><strong>Name:</strong> {{ mainContactDetailsArr?.name?.formatted_name }}</p>
    <p class="mb-5"><strong>D.O.B:</strong> {{ mainContactDetailsArr?.birthday }}</p>

    <p class="mb-5"><strong>Phone Numbers:</strong></p>
    <ul class="unorderListCls">
      <li *ngFor="let phone of mainContactDetailsArr.phones">
        {{ phone?.type }}: {{ phone?.phone }}
      </li>
    </ul>

    <p class="mb-5"><strong>Emails:</strong></p>
    <ul class="unorderListCls">
      <li *ngFor="let email of mainContactDetailsArr.emails">
        {{ email?.type }}: {{ email?.email }}
      </li>
    </ul>
    <p class="mb-5"><strong>Addresses:</strong></p>
    <ul class="unorderListCls">
      <li *ngFor="let address of mainContactDetailsArr.addresses">
        {{ address?.type }}: {{ address?.email }} {{address?.street}} {{address?.city}} {{address?.state}}
        {{address?.country_code}} {{address?.country}} {{address?.zip}}
      </li>
    </ul>
    <p class="mb-5"><strong>Urls:</strong></p>
    <ul class="unorderListCls">
      <li *ngFor="let url of mainContactDetailsArr.urls">
        {{ url?.type }}: {{ url?.url }}
      </li>
    </ul>
  </ng-container>
</p-dialog>



<!-- email code dynamic -->
<p-dialog header="Compose Email" [modal]="true" [(visible)]="emailPopUpTrueFalse" [style]="{ width: '85rem' }"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }">
  <div class="surface-section grid mt-2 grid-nogutter formgrid p-4 gap-3 md:surface-border md:border-1 border-round"
    style="    max-height: 100%;
    padding: 10px !important;
    border-color: cadetblue;
    height: auto;
">
    <div class="col-6 field flex flex-wrap" style="height: 40px;">
      <span for="to" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">Account</span>
      <span class="p-input-icon-right col-12 mb-0 md:col-10 md:mb-0">
        <p-dropdown [options]="accountDropdown" [(ngModel)]="newMail.from" optionLabel="label" optionValue="value"
          class="p-inputtext-sm newAddedCls newCssAdded" optionValue="value" (onSelect)="chanegAc($event)"></p-dropdown>

      </span>
    </div>
    <div class="col-6 field flex flex-wrap" style="height: 40px;">
      <span for="template" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">To</span>
      <span class="p-input-icon-right col-12 mb-0 md:col-10 md:mb-0">
        <p-chips [(ngModel)]="resultArray" #chips (onAdd)="onAddE($event)" (onRemove)="onRemoveE($event)">
        </p-chips>
        <input id="to" type="text" pInputText [(ngModel)]="newMail.to" (input)="filterMails()"
          (keyup.enter)="newValueDetails()" (blur)="updateValueNew()"
          class="w-full pl-0 text-900 font-semibold p-inputtext-sm" style="position: relative;
                bottom: 45px;
                border-bottom: none;
                outline: none;
                box-shadow: none;
                border-bottom-left-radius: 0;
                border-bottom-right-radius: 0;" placeholder="To" autocomplete="off" />
        <ul *ngIf="filteredMails.length > 0" class="card autocomplete-list" style="    margin: 5px;
                    text-align: left;
                    padding-left: 0;">
          <li *ngFor="let item of filteredMails" (click)="onSelect(item)">
            {{ item.name }}
          </li>
        </ul>
      </span>
    </div>
    <div class="col-6 field flex flex-wrap" style="height: 40px;margin-top: 3px;">
      <span for="template" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">CC</span>
      <span class="p-input-icon-right col-12 mb-0 md:col-10 md:mb-0">
        <p-chips [(ngModel)]="resultArrayCC" #chips (onAdd)="onAddECC($event)" (onRemove)="onRemoveECC($event)">
        </p-chips>
        <input id="cc" type="text" pInputText [(ngModel)]="fld_CC" (input)="filterMailsCC()"
          (keyup.enter)="newValueDetailsCC()" (blur)="updateValueNewCC()"
          class="w-full pl-0 text-900 font-semibold p-inputtext-sm" style="position: relative;
                    bottom: 45px;
                    border-bottom: none;
                    outline: none;
                    box-shadow: none;
                    border-bottom-left-radius: 0;
                    border-bottom-right-radius: 0;" placeholder="CC" autocomplete="off" />
        <ul *ngIf="filteredMailsCC.length > 0" class="card autocomplete-list" style="    margin: 5px;
                        text-align: left;
                        padding-left: 0;">
          <li *ngFor="let item of filteredMailsCC" (click)="onSelectCC(item)">
            {{ item.name }}
          </li>
        </ul>
      </span>
    </div>
    <div class="col-6 field flex flex-wrap" style="height: 40px;">
      <span for="template" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">BCC</span>
      <span class="p-input-icon-right col-12 mb-0 md:col-10 md:mb-0">
        <p-chips [(ngModel)]="resultArrayBCC" #chips (onAdd)="onAddEBCC($event)" (onRemove)="onRemoveEBCC($event)">
        </p-chips>
        <input id="bcc" type="text" pInputText [(ngModel)]="fld_BCC" (input)="filterMailsBCC()"
          (keyup.enter)="newValueDetailsBCC()" (blur)="updateValueNewBCC()"
          class="w-full pl-0 text-900 font-semibold p-inputtext-sm" style="position: relative;
                    bottom: 45px;
                    border-bottom: none;
                    outline: none;
                    box-shadow: none;
                    border-bottom-left-radius: 0;
                    border-bottom-right-radius: 0;" placeholder="BCC" autocomplete="off" />
        <ul *ngIf="filteredMailsBCC.length > 0" class="card autocomplete-list" style="    margin: 5px;
                        text-align: left;
                        padding-left: 0;">
          <li *ngFor="let item of filteredMailsBCC" (click)="onSelectBCC(item)">
            {{ item.name }}
          </li>
        </ul>
      </span>
    </div>
    <div class="col-6 field flex flex-wrap">
      <span for="Subject" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">Subject</span>
      <span class="p-input-icon-right  col-12 mb-0 md:col-10 md:mb-0">

        <input id="subject" type="text" pInputText [(ngModel)]="newMail.title" placeholder="Subject"
          class="w-full pl-7 text-900 font-semibold p-inputtext-sm newAddedOne" autocomplete="off" />
        <i class="pi pi-pencil" style="right: 1.5rem;"></i>
      </span>
    </div>
    <div class="col-6 field flex flex-wrap">
      <span for="template" class="text-900 font-semibold col-12 mb-0 md:col-2 md:mb-0"
        style="padding-top: 10px;">Template</span>
      <span class="p-input-icon-right col-12 mb-0 md:col-10 md:mb-0">
        <p-dropdown [options]="templateArr" [(ngModel)]="selectTemp" optionLabel="label" optionValue="value"
          placeholder="Select Template" class="p-inputtext-sm gettingDataCls newCssAdded" optionValue="value" (click)="getTemplate()"
          (onSelect)="selectedReplyTemplate($event)" (onChange)="selectedReplyTemplate($event)"></p-dropdown>
      </span>
    </div>

    <div class="col-12" style="padding: 0 14px;">
      <p-fileUpload accept="image/jpeg,image/png,image/gif,application/vnd.ms-excel,application/pdf,
                    application/msword,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                    application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                    audio/mpeg,video/mp4" maxFileSize="50000000" [multiple]="true" customUpload="true"
        (uploadHandler)="uploadHandler($event)" (onComplete)="onUpload($event)" [multiple]="true">
      </p-fileUpload>
    </div>
    <div class="col-12 field" style="padding: 0 14px;">
      <p-editor [style]="{'height':'150px'}" [(ngModel)]="newMail.message"></p-editor>
      <div *ngIf="signature" style="border: 1px solid lightgray; 
        max-height: 100%;
        border-radius: 8px;
        height: auto;
        padding: 20px;" [readonly]="true" [innerHTML]="signature | htmlconverter"></div>

    </div>
    <div class="col-12 field" style="padding: 0 14px;">
      <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
    </div>
    <div class="col-12 field" style="padding: 0 14px;">
       <!-- ticketing dashboard start -->
       <div class="p-fluid formgrid grid overflow-y-auto" style="padding: 10px;
       width: 100%;
       margin: auto;" *ngIf="newTicketFlag1">
             <div class="col-12 md:col-12 card">
               
               <div class="cardTicket dispositioncard2">
                 <div class="cardTicket" *ngIf="showTicketCard">
                   <form [formGroup]="customForm">
                     <div>
                       <div class=" dynamic-form-card">
                         <div class="p-fluid formgrid grid">
                           <ng-container *ngFor="let field of formFields">
                             <div *ngIf="field.fld_isNewRow==true"
                               style="min-inline-size: -webkit-fill-available !important;">
                             </div>
                             <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">{{field.separatorText}}
                             </div>
                             <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2"
                               *ngIf="field.fld_Enable_Search==false">
                               <span style="padding-left:10px; ">{{field.name}}</span>
                             </div>
                             <div class="field col-12 md:col-2">
                               <span
                                 *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true && field.fld_Enable_Search==false">
                                 <div
                                   *ngIf="field.name == 'Phone Number' || field.name == 'PhoneNo' || field.name == 'PhoneNo*' || field.name == 'Phone No'">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName" *ngIf="!isMasked"
                                     required="field.required" class="p-inputtext-sm" style=" user-select: none !important;">
     
                                   <input type="text" pInputText id="phoneInput" *ngIf="isMasked" required="field.required"
                                     class="p-inputtext-sm" style=" user-select: none !important;">
     
                                 </div>
     
                                 <!-- <div *ngIf="!(field.name == 'Phone Number')"> -->
                                 <div
                                   *ngIf="!(field.name == 'Phone Number' ||  field.name == 'PhoneNo' || field.name == 'PhoneNo*'  || field.name == 'Phone No')">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable">
                                 </div>
                               </span>
                               <span
                                 *ngIf="field.fld_Enable_Search==true && field.isUsed==true && myStudentFiledTrueFalse && !teacherFiledTrueFalse">
                                 <div
                                   *ngIf="field.name === 'Student Id' || field.name === 'Student Name' || field.name === 'Grade'">
                                   <div style="font-size:11px !important; margin-top:5px;">
                                     <span style="padding-left:10px; ">{{field.name}}</span>
                                   </div>
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                     style="user-select: none !important;">
                                 </div>
                               </span>
                               <span
                                 *ngIf="field.fld_Enable_Search==true && field.isUsed==true && teacherFiledTrueFalse && !myStudentFiledTrueFalse">
                                 <div
                                   *ngIf="field.name === 'Teacher Code' || field.name === 'Teacher Name' || field.name === 'Registered Mobile Number'">
                                   <div style="font-size:11px !important; margin-top:5px;">
                                     <span style="padding-left:10px; ">{{field.name}}</span>
                                   </div>
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                     style="user-select: none !important;">
                                 </div>
                               </span>
                               <span
                                 *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true ">
                                 <ng-container *ngIf="!hideDropDownEnableDIsable">
                                   <div *ngIf="field.name === 'School Code'">
                                     <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                         class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                         required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstParentValue($event,field)" (onChange)="firstParentValue($event,field)"
                                                         [filter]="true" filterBy="label">
                                                     </p-dropdown> -->
                                     <p-dropdown [options]="selctedSchoolCode" [(ngModel)]="schoolCodeValue"
                                       placeholder="Select" [editable]="true" [ngModelOptions]="{standalone: true}"
                                       [filter]="true" filterBy="sclCode" (onFilter)="customFilterFunction($event)"
                                       (onClear)="ocClearData($event)" optionLabel="sclCode"
                                       (onSelect)="checkValueAfterClick($event)" (onChange)="checkValueAfterClick($event)">
                                       <ng-template pTemplate="selectedItem" let-selectedUser>
                                         <div class="selectedUser-item">
                                           <div>{{selectedUser.sclCode}}</div>
                                         </div>
                                       </ng-template></p-dropdown>
                                   </div>
                                   <ng-container>
                                     <div *ngIf="field.name === 'School Name'">
                                       <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="schoolNameValue"
                                         [ngModelOptions]="{standalone: true}" />
                                     </div>
                                     <div *ngIf="field.name === 'District'">
                                       <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="districtValue"
                                         [ngModelOptions]="{standalone: true}" />
                                     </div>
                                     <div *ngIf="field.name === 'Block Name'">
                                       <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="blockNameValue"
                                         [ngModelOptions]="{standalone: true}" />
                                     </div>
                                   </ng-container>
     
                                 </ng-container>
                                 <ng-container
                                   *ngIf="hideDropDownEnableDIsable && field.name != 'Designation' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)' &&  field.name != 'Bot Name'">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                     style="user-select: none !important;">
                                   <span (click)="returnDropDownFirst" *ngIf="field.name === 'School Code'" style="    position: relative; 
                                          float: right;
                                          bottom: 43px;
                                          left: 6px;">
                                     <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownFirst()"
                                       sty></i>
                                   </span>
                                 </ng-container>
                                 <ng-container
                                   *ngIf="hidePropertyValueEnable && field.name != 'Designation'   &&  field.name != 'Bot Name' && field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name'">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                                     style="user-select: none !important;">
                                   <span (click)="returnDropDownSecond" *ngIf="field.name === 'Problem Reported'" style="    position: relative;
                                          float: right;
                                          bottom: 43px;
                                          left: 6px;">
                                     <i class="pi pi-times-circle" style="font-size: 20px"
                                       (click)="returnDropDownSecond()"></i>
                                   </span>
                                 </ng-container>
                                 <div
                                   *ngIf="field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)'">
                                   <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                     (onSelect)="getingBotNameValue($event,field)"
                                     (onChange)="getingBotNameValue($event,field)" class="p-inputtext-sm"
                                     [formControlName]="field.fld_FieldName" required="field.required" placeholder="select"
                                     [readonly]="!field.isEditable" [filter]="true" filterBy="label">
                                   </p-dropdown>
                                 </div>
                                 <ng-container *ngIf="!hidePropertyValueEnable">
                                   <div *ngIf="field.name === 'Problem Reported'">
                                     <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                     class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                     required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstProblemDropDownValue($event,field)" (onChange)="firstProblemDropDownValue($event,field)"
                                                     [filter]="true" filterBy="label">
                                                 </p-dropdown> -->
                                     <p-dropdown [options]="getValueParakhBot" [(ngModel)]="problemReportedValue"
                                       [ngModelOptions]="{standalone: true}" optionLabel="value" optionValue="value"
                                       class="p-inputtext-sm" placeholder="Select"
                                       (onSelect)="firstProblemDropDownValue($event,field)"
                                       (onChange)="firstProblemDropDownValue($event,field)" [filter]="true" filterBy="value">
                                       <ng-template pTemplate="selectedItem" let-selectedUser>
                                         <div class="selectedUser-item" style="width: 100px !important;">
                                           <div>{{selectedUser.value}}</div>
                                         </div>
                                       </ng-template>
                                     </p-dropdown>
                                   </div>
                                   <div *ngIf="field.name === 'Problem Category' && mainProblemDropDownValue">
                                     <p-dropdown [options]="ProblemCategoryArr" optionlabel="label" optionValue="value"
                                       class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                       required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                       (onSelect)="ProblemCategoryVFun($event,field)"
                                       (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                                     </p-dropdown>
                                   </div>
                                   <div *ngIf="field.name === 'Problem Category' && !mainProblemDropDownValue">
                                     <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                       class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                       required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                       (onSelect)="ProblemCategoryVFun($event,field)"
                                       (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                                     </p-dropdown>
                                   </div>
                                   <div *ngIf="field.name === 'Dependent upon (State/CG)' && mainNewVariableCheckDepenedent">
                                     <p-dropdown [options]="dependentVariavbles" optionlabel="label" optionValue="value"
                                       class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                       required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                       (onSelect)="DependentuponFunc($event,field)"
                                       (onChange)="DependentuponFunc($event,field)" [filter]="true" filterBy="label">
                                     </p-dropdown>
                                   </div>
                                   <div
                                     *ngIf="field.name === 'Dependent upon (State/CG)' && !mainNewVariableCheckDepenedent">
                                     <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                       class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                       required="field.required" placeholder="select" [readonly]="!field.isEditable"
                                       (onSelect)="DependentuponFunc($event,field)"
                                       (onChange)="DependentuponFunc($event,field)" [filter]="true" filterBy="label">
                                     </p-dropdown>
                                   </div>
                                 </ng-container>
     
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                                     required="field.required" [readonly]="!field.isEditable">
                                   </p-checkbox>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-radioButton [formControlName]="field.fld_FieldName" required="field.required"
                                     [readonly]="!field.isEditable">
                                   </p-radioButton>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-listbox [formControlName]="field.fld_FieldName" optionLabel="name"
                                     required="field.required" [readonly]="!field.isEditable"></p-listbox>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <textarea pInputTextarea [formControlName]="field.fld_FieldName" required="field.required"
                                     [readonly]="!field.isEditable"></textarea>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-multiSelect [options]="cities" class="p-inputtext-sm" optionLabel="name"
                                     required="field.required" [formControlName]="field.fld_FieldName" placeholder="select"
                                     [readonly]="!field.isEditable"></p-multiSelect>
                                 </div>
                               </span>
                             </div>
                           </ng-container>
                         </div>
                         <!-- <div class="field col-12 md:col-5 flex">
                                 <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
                                 <div style="margin: 0 5px;"></div>
                                 <p-button label="Open DM Chat" (click)="dmChat()" [hidden]="!liveDM"></p-button>
                             </div> -->
                       </div>
                     </div>
                   </form>
                   <!-- assign by && Ticket Status -->
                   <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                     <div class="col-12 mb-0 md:col-2 md:mb-0">Assigned By:<span style="color:red">*</span></div>
                     <div class="col-12 mb-0 md:col-3 md:mb-0">
                       <input type="text" pInputText [(ngModel)]="selectedAssignedBy" readonly="true"
                         class="p-inputtext-sm" />
                     </div>
     
                     <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Status<span style="color:red">*</span></div>
                     <div class="col-12 mb-0 md:col-3 md:mb-0">
                       <p-dropdown class="p-inputtext-sm" id="ticketStatus" [options]="ticketStatusDropdownData"
                         [disabled]="disabledTicketFields" [filter]="true" filterBy="label" optionLabel="label"
                         optionValue="value" [(ngModel)]="selectedticketStatus" [showClear]="true" placeholder="Select"
                         (onClick)="getTicketStatus()">
                         <ng-template let-selectedType pTemplate="item">
                           <div class="selectedType-item">
                             <div>{{selectedType.label}}</div>
                           </div>
                         </ng-template>
                       </p-dropdown>
                     </div>
                   </div>
     
                   <!-- ticket type -->
                   <!-- <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                         <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type:<span style="color:red">*</span></div>
                         <div class="col-12 mb-0 md:col-3 md:mb-0">
                             <i class="pi pi-chevron-circle-left" style="font-size: 1.7rem"
                                 (click)="previousIconTicketType()"></i>
                             <p-dropdown class="p-inputtext-sm" id="ticketType" [options]="ticketTypeDropdownData"
                                 appendTo="body" [disabled]="disabledTicketFields" [filter]="true" filterBy="label"
                                 optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType" [showClear]="true"
                                 placeholder="Select ">
                                 <ng-template let-selectedType pTemplate="item">
                                     <div class="selectedType-item">
                                         <div>{{selectedType.label}}</div>
                                     </div>
                                 </ng-template>
                             </p-dropdown>
                             <i class="pi pi-chevron-circle-right" style="font-size: 1.7rem"
                                 (click)="forwardIconTicketType()"></i>
                         </div>
                     </div> -->
     
                   <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                     <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type:<span style="color:red">*</span></div>
     
                     <!-- 1st Dropdown -->
                     <div class="col-12 mb-0 md:col-3 md:mb-0" *ngFor="let item of arrObj; let i = index">
                       <p-dropdown class="p-inputtext-sm" id="ticketType[i]" [options]="ticketTypeDropdownData[i]"
                         [disabled]="disabledTicketFields" appendTo="body" [filter]="true" filterBy="label"
                         optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType[i] " [showClear]="true"
                         placeholder="Select" (onChange)="ticketTypeDropdown(i)">
                         <ng-template let-selectedType pTemplate="item">
                           <div class="selectedType-item">
                             <div>{{selectedType.label}}</div>
                           </div>
                         </ng-template>
                       </p-dropdown>
                     </div>
     
                   </div>
     
     
                   <!-- tree -->
                   <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                     <div class="col-12 mb-0 md:col-12 md:mb-0">Tree : {{tree}}</div>
     
                   </div>
     
                   <!-- voice file -->
                   <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
                     *ngIf="voicefile">
                     <div class="col-12 mb-0 md:col-2 md:mb-0">Voice File:</div>
                     <div class="col-12 mb-0 md:col-6 md:mb-0">
                       <audio controls>
                         <source [src]="voicefile" type="audio/wav">
                       </audio>
                     </div>
                   </div>
     
                   <!-- agent remarks && moved to below just above the callback section -->
                   <!-- <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                         <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
                         <div class="col-12 mb-0 md:col-6 md:mb-0">
                             <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea
                                 [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
                         </div>
                     </div> -->
                 </div>
     
                 <div class="cardTicket" *ngIf="showDynaTicketCard">
                   <form [formGroup]="ticketForm">
                     <div>
                       <div class="dynamic-form-card">
                         <div class="p-fluid formgrid grid" style="padding-left: 10px !important; margin-top:10px;">
                           <ng-container *ngFor="let field of ticketFields">
                             <div *ngIf="field.fld_isNewRow==true"
                               style="min-inline-size: -webkit-fill-available !important;">
                             </div>
                             <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">
                               <div class="flex flex-wrap">
                                 <span>{{field.separatorText}}</span>
                                 <span class="remaining-space"></span>
                               </div>
                             </div>
                             <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2">
                               <span>{{field.name}}</span>
                             </div>
                             <div class="field col-12 md:col-2">
                               <span
                                 *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true">
                                 <div *ngIf="field.name === 'Phone Number'">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm">
                                 </div>
     
                                 <div *ngIf="!(field.name == 'Phone Number')">
                                   <input type="text" pInputText [formControlName]="field.fld_FieldName"
                                     required="field.required" class="p-inputtext-sm">
                                 </div>
     
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                                 <div>
     
                                   <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                                     required="field.required">
                                   </p-checkbox>
                                 </div>
     
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                                 <div *ngFor="let radioOption of field.selectItems">
                                   <p-radioButton binary="true" inputId="binary" [value]="radioOption.value"
                                     [formControlName]="field.fld_FieldName"></p-radioButton>
                                   <label class="ml-2">{{ radioOption.label }}</label>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 7 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-calendar [formControlName]="field.fld_FieldName" optionLabel="name"
                                     required="field.required"></p-calendar>
                                 </div>
                               </span>
     
                               <span
                                 *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <textarea pInputTextarea [formControlName]="field.fld_FieldName"
                                     required="field.required"></textarea>
                                 </div>
                               </span>
     
                               <!-- <span
                                                 *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                                                 <div>
                                                     <p-multiSelect [options]="field.selectItems" class="p-inputtext-sm"
                                                         optionLabel="label" optionValue="value" required="field.required"
                                                         [formControlName]="field.fld_FieldName"
                                                         defaultLabel="Select a City"></p-multiSelect>
                                                 </div>
                                             </span> -->
                               <span
                                 *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-multiSelect [options]="field.selectItems" class="p-inputtext-sm" optionLabel="label"
                                     optionValue="value" [formControlName]="field.fld_FieldName"
                                     defaultLabel="Select Value"></p-multiSelect>
                                 </div>
     
                               </span>
     
                               <!-- <span
                                             *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                                             <div *ngFor="let category of field.selectItems" class="field-checkbox">
                                                 <p-checkbox name="group" [value]="category.value" [formControlName]="field.fld_FieldName" [inputId]="category.key"></p-checkbox>
                                                 <label [for]="category.key">{{ category.label }}</label>
                                             </div>
                                             </span> -->
     
                               <span
                                 *ngIf="field.controlType.value == 8 && field.displayInClient == true && field.isUsed == true">
                                 <div *ngFor="let category of field.selectItems" class="field-checkbox">
                                   <p-checkbox name="group" [value]="category.value" [(ngModel)]="abc"
                                     [formControlName]="field.fld_FieldName" [inputId]="category.key"></p-checkbox>
                                   <label [for]="category.key">{{ category.label }}</label>
     
                                 </div>
                                 <!-- {{category.value |json}} -->
                               </span>
     
     
                               <span
                                 *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true">
                                 <div>
                                   <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                     class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                                     placeholder="select" [filter]="true" filterBy="label">
                                   </p-dropdown>
                                 </div>
                               </span>
                             </div>
     
                           </ng-container>
                         </div>
                       </div>
                     </div>
                   </form>
     
                 </div>
     
                 <div class="cardTicket" *ngIf="showTicketCard">
                   <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                     <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
                     <div class="col-12 mb-0 md:col-6 md:mb-0">
                       <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea class="p-inputtext"
                         [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
                     </div>
                   </div>
                 </div>
     
     
                 <div class="cardTicket" *ngIf="showTicketCard">
                   <div class="grid forms-grid flex-row p-fluid"
                     style="padding-left: 10px !important; margin-top:10px;padding-bottom: 11px;">
     
                     <!-- <div class="col-12 mb-0 md:col-1 md:mb-0">
                       <div>Ticket Id</div>
                     </div>
                     <div class="col-12 mb-0 md:col-2 md:mb-0">
                       <div><input class="p-inputtext-sm" type="text" pInputText [(ngModel)]="ticketNo" /></div>
                     </div> -->
     
                     <!-- <div class="col-12 mb-0 md:col-3 md:mb-0">
                       <button (click)="callHistory()" pButton pRipple type="button" label="Ticket History"
                         style="background: #128c7e;    white-space: pre;
    width: 100%;">
                       </button>
                     </div> -->
                     <div class="col-12 mb-0 md:col-2 md:mb-0">
                       <button pButton pRipple type="submit" style="background: #128c7e;" label="Save"
                         (click)="saveDynamicLeadCustField()" *ngIf="showSaveButton">
                       </button>
                       <!-- <button pButton pRipple type="submit" style="background: #128c7e;" label="Save" (click)="saveTicketData()"
                                 *ngIf="showSaveButton">
                             </button> -->
     
                       <button pButton (click)="updateTiecket()" pButton pRipple style="background: #128c7e;" type="Update"
                         label="Update" *ngIf="showUpdateButton">
                       </button>
                     </div>
                   </div>
                 </div>
               </div>
     
     
     
             </div>
           </div>
           <!-- ticketing dashboard end-->
    </div>
    <div class="col-12 flex column-gap-3 justify-content-end">
      <!-- <button pButton pRipple type="button" class="p-button-primary h-3rem w-full sm:w-auto" icon="pi pi-send"
          label="Draft" (click)="draftMail()"></button> &nbsp;&nbsp;&nbsp; -->
      <!-- <button pButton pRipple type="button" class="p-button-primary h-3rem w-full sm:w-auto" icon="pi pi-send"   [disabled]="!valueSaveTrue"
          label="Send" (click)="sendMail()"></button> -->
      <button pButton pRipple type="button" class="p-button-primary h-3rem w-full sm:w-auto" icon="pi pi-send"
        label="Send" (click)="sendMail()"></button>
    </div>
  </div>
</p-dialog>

<!-- email code dynamic end -->

<!-- ticket Data -->
<p-dialog position="center" [(visible)]="historyDialogBox" [style]="{width: '85vw'}" header="Ticket History"
  [modal]="true" styleClass="p-fluid">
  <form [formGroup]="customForm">
    <div>
      <div class=" dynamic-form-card">
        <div class="p-fluid formgrid grid">
          <ng-container *ngIf="formFields">
            <ng-container *ngFor="let field of formFields">
              <div *ngIf="field.fld_isNewRow==true" style="min-inline-size: -webkit-fill-available !important;">
              </div>
              <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">{{field.separatorText}}</div>
              <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2"
                *ngIf="field.fld_Enable_Search==false">
                <span style="padding-left:10px; ">{{field.name}}</span>
              </div>
              <div class="field col-12 md:col-2">
                <span
                  *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true && field.fld_Enable_Search==false">
                  <div
                    *ngIf="field.name == 'Phone Number' || field.name == 'PhoneNo' || field.name == 'PhoneNo*' || field.name == 'Phone No'">
                    <input type="text" pInputText [formControlName]="field.fld_FieldName" *ngIf="!isMasked"
                      required="field.required" class="p-inputtext-sm" style=" user-select: none !important;">
  
                    <input type="text" pInputText id="phoneInput" *ngIf="isMasked" required="field.required"
                      class="p-inputtext-sm" style=" user-select: none !important;">
  
                  </div>
  
                  <!-- <div *ngIf="!(field.name == 'Phone Number')"> -->
                  <div
                    *ngIf="!(field.name == 'Phone Number' ||  field.name == 'PhoneNo' || field.name == 'PhoneNo*'  || field.name == 'Phone No')">
                    <input type="text" pInputText [formControlName]="field.fld_FieldName"
                      required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable">
                  </div>
                </span>
                <span
                  *ngIf="field.fld_Enable_Search==true && field.isUsed==true && myStudentFiledTrueFalse && !teacherFiledTrueFalse">
                  <div
                    *ngIf="field.name === 'Student Id' || field.name === 'Student Name' || field.name === 'Grade'">
                    <div style="font-size:11px !important; margin-top:5px;">
                      <span style="padding-left:10px; ">{{field.name}}</span>
                    </div>
                    <input type="text" pInputText [formControlName]="field.fld_FieldName"
                      required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                      style="user-select: none !important;">
                  </div>
                </span>
                <span
                  *ngIf="field.fld_Enable_Search==true && field.isUsed==true && teacherFiledTrueFalse && !myStudentFiledTrueFalse">
                  <div
                    *ngIf="field.name === 'Teacher Code' || field.name === 'Teacher Name' || field.name === 'Registered Mobile Number'">
                    <div style="font-size:11px !important; margin-top:5px;">
                      <span style="padding-left:10px; ">{{field.name}}</span>
                    </div>
                    <input type="text" pInputText [formControlName]="field.fld_FieldName"
                      required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                      style="user-select: none !important;">
                  </div>
                </span>
                <span *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true ">
                  <ng-container *ngIf="!hideDropDownEnableDIsable">
                    <div *ngIf="field.name === 'School Code'">
                      <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                            class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                            required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstParentValue($event,field)" (onChange)="firstParentValue($event,field)"
                                            [filter]="true" filterBy="label">
                                        </p-dropdown> -->
                      <p-dropdown [options]="selctedSchoolCode" [(ngModel)]="schoolCodeValue" placeholder="Select"
                        [editable]="true" [ngModelOptions]="{standalone: true}" [filter]="true" filterBy="sclCode"
                        (onFilter)="customFilterFunction($event)" (onClear)="ocClearData($event)"
                        optionLabel="sclCode" (onSelect)="checkValueAfterClick($event)"
                        (onChange)="checkValueAfterClick($event)">
                        <ng-template pTemplate="selectedItem" let-selectedUser>
                          <div class="selectedUser-item">
                            <div>{{selectedUser.sclCode}}</div>
                          </div>
                        </ng-template></p-dropdown>
                    </div>
                    <ng-container>
                      <div *ngIf="field.name === 'School Name'">
                        <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="schoolNameValue"
                          [ngModelOptions]="{standalone: true}" />
                      </div>
                      <div *ngIf="field.name === 'District'">
                        <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="districtValue"
                          [ngModelOptions]="{standalone: true}" />
                      </div>
                      <div *ngIf="field.name === 'Block Name'">
                        <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="blockNameValue"
                          [ngModelOptions]="{standalone: true}" />
                      </div>
                    </ng-container>
  
                  </ng-container>
                  <ng-container
                    *ngIf="hideDropDownEnableDIsable && field.name != 'Designation' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)' &&  field.name != 'Bot Name'">
                    <input type="text" pInputText [formControlName]="field.fld_FieldName"
                      required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                      style="user-select: none !important;">
                    <span (click)="returnDropDownFirst" *ngIf="field.name === 'School Code'" style="    position: relative; 
                             float: right;
                             bottom: 43px;
                             left: 6px;">
                      <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownFirst()"
                        sty></i>
                    </span>
                  </ng-container>
                  <ng-container
                    *ngIf="hidePropertyValueEnable && field.name != 'Designation'   &&  field.name != 'Bot Name' && field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name'">
                    <input type="text" pInputText [formControlName]="field.fld_FieldName"
                      required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                      style="user-select: none !important;">
                    <span (click)="returnDropDownSecond" *ngIf="field.name === 'Problem Reported'" style="    position: relative;
                             float: right;
                             bottom: 43px;
                             left: 6px;">
                      <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownSecond()"></i>
                    </span>
                  </ng-container>
                  <div
                    *ngIf="field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)'">
                    <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                      (onSelect)="getingBotNameValue($event,field)" (onChange)="getingBotNameValue($event,field)"
                      class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                      placeholder="select" [readonly]="!field.isEditable" [filter]="true" filterBy="label">
                    </p-dropdown>
                  </div>
                  <ng-container *ngIf="!hidePropertyValueEnable">
                    <div *ngIf="field.name === 'Problem Reported'">
                      <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                        required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstProblemDropDownValue($event,field)" (onChange)="firstProblemDropDownValue($event,field)"
                                        [filter]="true" filterBy="label">
                                    </p-dropdown> -->
                      <p-dropdown [options]="getValueParakhBot" [(ngModel)]="problemReportedValue"
                        [ngModelOptions]="{standalone: true}" optionLabel="value" optionValue="value"
                        class="p-inputtext-sm" placeholder="Select"
                        (onSelect)="firstProblemDropDownValue($event,field)"
                        (onChange)="firstProblemDropDownValue($event,field)" [filter]="true" filterBy="value">
                        <ng-template pTemplate="selectedItem" let-selectedUser>
                          <div class="selectedUser-item" style="width: 100px !important;">
                            <div>{{selectedUser.value}}</div>
                          </div>
                        </ng-template>
                      </p-dropdown>
                    </div>
                    <div *ngIf="field.name === 'Problem Category' && mainProblemDropDownValue">
                      <p-dropdown [options]="ProblemCategoryArr" optionlabel="label" optionValue="value"
                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                        placeholder="select" [readonly]="!field.isEditable"
                        (onSelect)="ProblemCategoryVFun($event,field)"
                        (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                      </p-dropdown>
                    </div>
                    <div *ngIf="field.name === 'Problem Category' && !mainProblemDropDownValue">
                      <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                        placeholder="select" [readonly]="!field.isEditable"
                        (onSelect)="ProblemCategoryVFun($event,field)"
                        (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                      </p-dropdown>
                    </div>
                    <div *ngIf="field.name === 'Dependent upon (State/CG)' && mainNewVariableCheckDepenedent">
                      <p-dropdown [options]="dependentVariavbles" optionlabel="label" optionValue="value"
                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                        placeholder="select" [readonly]="!field.isEditable"
                        (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                        [filter]="true" filterBy="label">
                      </p-dropdown>
                    </div>
                    <div *ngIf="field.name === 'Dependent upon (State/CG)' && !mainNewVariableCheckDepenedent">
                      <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                        class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                        placeholder="select" [readonly]="!field.isEditable"
                        (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                        [filter]="true" filterBy="label">
                      </p-dropdown>
                    </div>
                  </ng-container>
  
                </span>
  
                <span *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                  <div>
                    <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                      required="field.required" [readonly]="!field.isEditable">
                    </p-checkbox>
                  </div>
                </span>
  
                <span *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                  <div>
                    <p-radioButton [formControlName]="field.fld_FieldName" required="field.required"
                      [readonly]="!field.isEditable">
                    </p-radioButton>
                  </div>
                </span>
  
                <span *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                  <div>
                    <p-listbox [formControlName]="field.fld_FieldName" optionLabel="name"
                      required="field.required" [readonly]="!field.isEditable"></p-listbox>
                  </div>
                </span>
  
                <span *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                  <div>
                    <textarea pInputTextarea [formControlName]="field.fld_FieldName" required="field.required"
                      [readonly]="!field.isEditable"></textarea>
                  </div>
                </span>
  
                <span *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                  <div>
                    <p-multiSelect [options]="cities" class="p-inputtext-sm" optionLabel="name"
                      required="field.required" [formControlName]="field.fld_FieldName" placeholder="select"
                      [readonly]="!field.isEditable"></p-multiSelect>
                  </div>
                </span>
              </div>
            </ng-container>
          </ng-container>
         
        </div>
        <!-- <div class="field col-12 md:col-5 flex">
                  <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
                  <div style="margin: 0 5px;"></div>
                  <p-button label="Open DM Chat" (click)="dmChat()" [hidden]="!liveDM"></p-button>
              </div> -->
      </div>
    </div>
  </form>
  <div *ngFor="let ticketHistory of ticketTypeHistory">
    <div class="cardTicket" style="background-color:#128c7e;">
      <ul style="display: flex; color:white; margin-top:0rem; margin-bottom:0rem; padding-left:0.5rem;font-size: 10px;">
        <li>Ticket Id: {{ticketHistory.ticketID}}</li>
        <span style="margin-left:40px;"></span>
        <li>Source: {{ticketHistory.sourceName}}</li>
        <span style="margin-left:40px;"></span>
        <li>Campaign: {{ticketHistory.campName}}</li>
        <span style="margin-left:40px;"></span>
        <li>ActionNo: {{ticketHistory.action_No}}</li>
        <span style="margin-left:40px;"></span>
        <li>Ticket Time: {{ticketHistory.ticket_Time}}</li>
        <span style="margin-left:40px;"></span>
        <li>Duration: {{ticketHistory.ticketTime}}</li>
      </ul>

    </div>
    <div class="cardTicket">
  
      <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
        <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Start Time<span style="color:red">*</span> :</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.start_Time" readonly="true" class="p-inputtext-sm" />
        </div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket End Time<span style="color:red">*</span> :</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.ticketElapsedTime" readonly="true"
            class="p-inputtext-sm" />
        </div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">Duration<span style="color:red">*</span> :</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.ticketTime" readonly="true" class="p-inputtext-sm" />
        </div>
      </div>

      <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
        <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type<span style="color:red">*</span>:</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.ticket_type_name" readonly="true"
            class="p-inputtext-sm" />
        </div>


        <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Status<span style="color:red">*</span></div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.ticket_StatusName" readonly="true"
            class="p-inputtext-sm" />
        </div>


        <div class="col-12 mb-0 md:col-2 md:mb-0">Assigned By<span style="color:red">*</span>:</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.assignedByID" readonly="true"
            class="p-inputtext-sm" />
        </div>
      </div>


      <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
        <div class="col-12 mb-0 md:col-2 md:mb-0">UpdateBy<span style="color:red">*</span>:</div>
        <div class="col-12 mb-0 md:col-2 md:mb-0">
          <input type="text" pInputText [(ngModel)]="ticketHistory.updatedByID" readonly="true"
            class="p-inputtext-sm" />
        </div>

        <div class="col-12 mb-0 md:col-2 md:mb-0">Tree :</div>
        <div class="col-12 mb-0 md:col-6 md:mb-0">

        </div>
      </div>

      <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
        *ngIf="ticketHistory.voicefile">
        <div class="col-12 mb-0 md:col-2 md:mb-0">Voice File:</div>
        <div class="col-12 mb-0 md:col-6 md:mb-0">
          <audio controls>
            <source [src]="ticketHistory.voicefile" type="audio/wav">
          </audio>
        </div>
      </div>

      <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
        <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
        <div class="col-12 mb-0 md:col-6 md:mb-0">
          <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea class="p-inputtext"
            [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="ticketHistory.remarks"></textarea>
        </div>
      </div>

      <!-- <form [formGroup]="ticketHistoryForm" *ngIf="ticketHistory.objticketDynaField"> -->
      <div *ngIf="ticketHistory.objticketDynaField">
        <div class="dynamic-form-card">
          <div class="p-fluid formgrid grid" style="padding-left: 10px !important; margin-top:10px;">

            <ng-container *ngFor="let field of ticketHistory.objticketDynaField | keyvalue">
              <div *ngIf="field.value.fld_isNewRow==true" style="min-inline-size: -webkit-fill-available !important;">
              </div>
              <div class="field col-12 md:col-12" *ngIf="field.value.isSeparator==true">
                {{field.value.separatorText}}</div>
              <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2">
                <span>{{field.value.name}}</span>
              </div>
              <div class="field col-12 md:col-2">
                <span
                  *ngIf="field.value.controlType.value == 0 && field.value.displayInClient==true && field.value.isUsed==true && field.value.isUsed==true || 
                                    field.value.controlType.value == 2 && field.value.displayInClient==true && field.value.isUsed==true || field.value.controlType.value == 7 && field.value.displayInClient==true && field.value.isUsed==true ||
                                    field.value.controlType.value == 5 && field.value.displayInClient==true && field.value.isUsed==true">

                  <div *ngIf="field.value.name === 'Phone Number'">
                    <input type="text" pInputText required="field.value.required" class="p-inputtext-sm"
                      [(ngModel)]="field.value.value" readonly="true">
                  </div>
                  <div *ngIf="!(field.value.name == 'Phone Number')">
                    <input type="text" pInputText required="field.value.required" class="p-inputtext-sm"
                      [(ngModel)]="field.value.value" readonly="true">
                  </div>

                </span>

                <span *ngIf="field.value.controlType.value == 8">
                  <div *ngFor="let category of field.value.selectItems" class="field-checkbox">
                    <p-checkbox name="group" [value]="category.value" [(ngModel)]="field.value.value"
                      readonly="true"></p-checkbox>
                    <label [for]="category.key">{{ category.label }}</label>
                  </div>
                  <!-- {{category.value |json}} -->
                </span>
                <span
                  *ngIf="field.value.controlType.value == 3 && field.value.displayInClient==true && field.value.isUsed==true">
                  <div>
                    <!-- {{field.value.value|json}} -->
                    <p-checkbox binary="true" inputId="binary" required="field.value.required"
                      [ngModel]="field.value.value === 'true'" readonly="true">
                    </p-checkbox>
                  </div>
                </span>

                <span *ngIf="field.value.controlType.value == 4">
                  <div *ngFor="let radioOption of field.value.selectItems">
                    <p-radioButton inputId="{{ radioOption.value }}" value="{{ radioOption.value }}"
                      [(ngModel)]="field.value.value" disabled="true"></p-radioButton>
                    <label class="ml-2">{{ radioOption.label }}</label>
                  </div>
                </span>

                <!-- <span *ngIf="field.value.controlType.value == 7 && field.value.displayInClient==true && field.value.isUsed==true">
                                    <div>
                                        <p-calendar optionLabel="name"
                                            required="field.value.required"></p-calendar>
                                    </div>
                                </span> -->

                <span
                  *ngIf="field.value.controlType.value == 1 && field.value.displayInClient==true && field.value.isUsed==true">
                  <div>
                    <textarea pInputTextarea required="field.value.required" [(ngModel)]="field.value.value"
                      readonly="true"></textarea>
                  </div>
                </span>
              </div>

            </ng-container>
          </div>
        </div>
      </div>
      <!-- </form> -->
    </div>
    <div style="margin-top:10px;"></div>
  </div>
</p-dialog>



<p-dialog position="center" [(visible)]="historyDialogBoxFormWithoutTicketing" [style]="{width: '85vw'}"
  header="Call History" [modal]="true" styleClass="p-fluid">
  <p-table [value]="callHistoryTableData" [resizableColumns]="true" columnResizeMode="expand"
    [tableStyle]="{'max-width': '60rem'}">
    <ng-template pTemplate="header">
      <tr>
        <th *ngIf="enableCallHistoryCRM"></th>

        <th pResizableColumn="campName" pSortableColumn="campName" style="width: 3.2px;">CampaignName
        </th>
        <th pResizableColumn="leadSet" pSortableColumn="leadSet" style="width:3.2px;">LeadSet
        </th>
        <th pResizableColumn="agentID" pSortableColumn="agentID" style="width:3.2px;">AgentNo
        </th>
        <th pResizableColumn="phoneNo" pSortableColumn="phoneNo" style="width:3.2px;">PhoneNo
        </th>
        <th pResizableColumn="callTime" pSortableColumn="callTime" style="width:3.2px;">CallTime
        </th>
        <th pResizableColumn="disposition" pSortableColumn="disposition" style="width:3.2px;">Disposition
        </th>
        <th pResizableColumn="solutionProvided" pSortableColumn="solutionProvided" style="width:3.2px;">
          SolnProvided
        </th>
        <th pResizableColumn="customerFeedBack" pSortableColumn="customerFeedBack" style="width:3.2px;">
          CustFeedBack
        </th>
        <th pResizableColumn="currentStatus" pSortableColumn="currentStatus" style="width:3.2px;">CurrStatus
        </th>
        <th pResizableColumn="thirdPartyCallID" pSortableColumn="thirdPartyCallID" style="width:3.2px;">
          3rdPartyID
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
      <tr>
        <td *ngIf="enableCallHistoryCRM"><i class="pi pi-eye" style="font-size: 1rem"
            (click)="openNonVoiceCustForm()"></i></td>

        <td>{{product.campName}} </td>
        <td>{{product.leadSet}}</td>
        <td>{{product.agentID}} </td>
        <td>{{product.phoneNo}} </td>
        <td>{{product.callTime}}</td>
        <td>{{product.disposition}} </td>
        <td>{{product.solutionProvided}} </td>
        <td>{{product.customerFeedBack}}</td>
        <td>{{product.currentStatus}} </td>
        <td>{{product.thirdPartyCallID}}</td>
      </tr>
    </ng-template>
  </p-table>
</p-dialog>
<p-dialog position="center" [(visible)]="getUdatedDialogData" [style]="{width: '85vw'}" header="Update Ticket"
  [modal]="true" styleClass="p-fluid">
  <div class="p-fluid formgrid grid overflow-y-auto" style="padding: 10px;
width: 100%;
margin: auto;">
    <div class="col-12 md:col-12 card">
      <div class="cardTicket dispositioncard2">

        <div class="cardTicket" style="background-color: #128c7e;
          height: 47px;
          display: flex;
          align-items: center;
          text-align: center;" *ngIf="showTicketCard">
          <ul style="display: flex; color:white; margin-top:0rem; margin-bottom:0rem; padding-left:0.5rem;font-size: 10px;">
            <li>Ticket Id: {{ticketNo}}</li>
            <span style="margin-left:40px;"></span>
            <li>Source: {{sourceName}}</li>
            <span style="margin-left:40px;"></span>
            <li>Campaign: {{ticketCampaignName}}</li>
            <span style="margin-left:40px;"></span>
            <li>ActionNo: {{actionNo}}</li>
            <span style="margin-left:40px;"></span>
            <li>Ticket Time: {{ticketTime}}</li>
            <span style="margin-left:40px;"></span>
            <li>Duration: {{ticketDuration}}</li>
          </ul>

        </div>
        <div class="cardTicket" *ngIf="showTicketCard">
          <form [formGroup]="customForm">
            <div>
              <div class=" dynamic-form-card">
                <div class="p-fluid formgrid grid">
                  <ng-container *ngFor="let field of formFields">
                    <div *ngIf="field.fld_isNewRow==true" style="min-inline-size: -webkit-fill-available !important;">
                    </div>
                    <div class="field col-12 md:col-12" *ngIf="field.isSeparator==true">{{field.separatorText}}</div>
                    <div style="font-size:11px !important; margin-top:5px;" class="field col-12 md:col-2"
                      *ngIf="field.fld_Enable_Search==false">
                      <span style="padding-left:10px; ">{{field.name}}</span>
                    </div>
                    <div class="field col-12 md:col-2">
                      <span
                        *ngIf="field.controlType.value == 0 && field.displayInClient==true && field.isUsed==true && field.isUsed==true && field.fld_Enable_Search==false">
                        <div
                          *ngIf="field.name == 'Phone Number' || field.name == 'PhoneNo' || field.name == 'PhoneNo*' || field.name == 'Phone No'">
                          <input type="text" pInputText [formControlName]="field.fld_FieldName" *ngIf="!isMasked"
                            required="field.required" class="p-inputtext-sm" style=" user-select: none !important;">

                          <input type="text" pInputText id="phoneInput" *ngIf="isMasked" required="field.required"
                            class="p-inputtext-sm" style=" user-select: none !important;">

                        </div>

                        <!-- <div *ngIf="!(field.name == 'Phone Number')"> -->
                        <div
                          *ngIf="!(field.name == 'Phone Number' ||  field.name == 'PhoneNo' || field.name == 'PhoneNo*'  || field.name == 'Phone No')">
                          <input type="text" pInputText [formControlName]="field.fld_FieldName"
                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable">
                        </div>
                      </span>
                      <span
                        *ngIf="field.fld_Enable_Search==true && field.isUsed==true && myStudentFiledTrueFalse && !teacherFiledTrueFalse">
                        <div
                          *ngIf="field.name === 'Student Id' || field.name === 'Student Name' || field.name === 'Grade'">
                          <div style="font-size:11px !important; margin-top:5px;">
                            <span style="padding-left:10px; ">{{field.name}}</span>
                          </div>
                          <input type="text" pInputText [formControlName]="field.fld_FieldName"
                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                            style="user-select: none !important;">
                        </div>
                      </span>
                      <span
                        *ngIf="field.fld_Enable_Search==true && field.isUsed==true && teacherFiledTrueFalse && !myStudentFiledTrueFalse">
                        <div
                          *ngIf="field.name === 'Teacher Code' || field.name === 'Teacher Name' || field.name === 'Registered Mobile Number'">
                          <div style="font-size:11px !important; margin-top:5px;">
                            <span style="padding-left:10px; ">{{field.name}}</span>
                          </div>
                          <input type="text" pInputText [formControlName]="field.fld_FieldName"
                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                            style="user-select: none !important;">
                        </div>
                      </span>
                      <span *ngIf="field.controlType.value == 2 && field.displayInClient==true && field.isUsed==true ">
                        <ng-container *ngIf="!hideDropDownEnableDIsable">
                          <div *ngIf="field.name === 'School Code'">
                            <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                                  class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                                  required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstParentValue($event,field)" (onChange)="firstParentValue($event,field)"
                                                  [filter]="true" filterBy="label">
                                              </p-dropdown> -->
                            <p-dropdown [options]="selctedSchoolCode" [(ngModel)]="schoolCodeValue" placeholder="Select"
                              [editable]="true" [ngModelOptions]="{standalone: true}" [filter]="true" filterBy="sclCode"
                              (onFilter)="customFilterFunction($event)" (onClear)="ocClearData($event)"
                              optionLabel="sclCode" (onSelect)="checkValueAfterClick($event)"
                              (onChange)="checkValueAfterClick($event)">
                              <ng-template pTemplate="selectedItem" let-selectedUser>
                                <div class="selectedUser-item">
                                  <div>{{selectedUser.sclCode}}</div>
                                </div>
                              </ng-template></p-dropdown>
                          </div>
                          <ng-container>
                            <div *ngIf="field.name === 'School Name'">
                              <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="schoolNameValue"
                                [ngModelOptions]="{standalone: true}" />
                            </div>
                            <div *ngIf="field.name === 'District'">
                              <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="districtValue"
                                [ngModelOptions]="{standalone: true}" />
                            </div>
                            <div *ngIf="field.name === 'Block Name'">
                              <input type="text" class="p-inputtext-sm" pInputText [(ngModel)]="blockNameValue"
                                [ngModelOptions]="{standalone: true}" />
                            </div>
                          </ng-container>

                        </ng-container>
                        <ng-container
                          *ngIf="hideDropDownEnableDIsable && field.name != 'Designation' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)' &&  field.name != 'Bot Name'">
                          <input type="text" pInputText [formControlName]="field.fld_FieldName"
                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                            style="user-select: none !important;">
                          <span (click)="returnDropDownFirst" *ngIf="field.name === 'School Code'" style="    position: relative; 
                                   float: right;
                                   bottom: 43px;
                                   left: 6px;">
                            <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownFirst()"
                              sty></i>
                          </span>
                        </ng-container>
                        <ng-container
                          *ngIf="hidePropertyValueEnable && field.name != 'Designation'   &&  field.name != 'Bot Name' && field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name'">
                          <input type="text" pInputText [formControlName]="field.fld_FieldName"
                            required="field.required" class="p-inputtext-sm" [readonly]="!field.isEditable"
                            style="user-select: none !important;">
                          <span (click)="returnDropDownSecond" *ngIf="field.name === 'Problem Reported'" style="    position: relative;
                                   float: right;
                                   bottom: 43px;
                                   left: 6px;">
                            <i class="pi pi-times-circle" style="font-size: 20px" (click)="returnDropDownSecond()"></i>
                          </span>
                        </ng-container>
                        <div
                          *ngIf="field.name != 'District' &&  field.name != 'School Name' && field.name != 'School Code' && field.name != 'Block Name' && field.name != 'Problem Reported' && field.name != 'Problem Category' && field.name != 'Dependent upon (State/CG)'">
                          <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                            (onSelect)="getingBotNameValue($event,field)" (onChange)="getingBotNameValue($event,field)"
                            class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                            placeholder="select" [readonly]="!field.isEditable" [filter]="true" filterBy="label">
                          </p-dropdown>
                        </div>
                        <ng-container *ngIf="!hidePropertyValueEnable">
                          <div *ngIf="field.name === 'Problem Reported'">
                            <!-- <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                                              class="p-inputtext-sm" [formControlName]="field.fld_FieldName"
                                              required="field.required" placeholder="select" [readonly]="!field.isEditable"  (onSelect)="firstProblemDropDownValue($event,field)" (onChange)="firstProblemDropDownValue($event,field)"
                                              [filter]="true" filterBy="label">
                                          </p-dropdown> -->
                            <p-dropdown [options]="getValueParakhBot" [(ngModel)]="problemReportedValue"
                              [ngModelOptions]="{standalone: true}" optionLabel="value" optionValue="value"
                              class="p-inputtext-sm" placeholder="Select"
                              (onSelect)="firstProblemDropDownValue($event,field)"
                              (onChange)="firstProblemDropDownValue($event,field)" [filter]="true" filterBy="value">
                              <ng-template pTemplate="selectedItem" let-selectedUser>
                                <div class="selectedUser-item" style="width: 100px !important;">
                                  <div>{{selectedUser.value}}</div>
                                </div>
                              </ng-template>
                            </p-dropdown>
                          </div>
                          <div *ngIf="field.name === 'Problem Category' && mainProblemDropDownValue">
                            <p-dropdown [options]="ProblemCategoryArr" optionlabel="label" optionValue="value"
                              class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                              placeholder="select" [readonly]="!field.isEditable"
                              (onSelect)="ProblemCategoryVFun($event,field)"
                              (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                            </p-dropdown>
                          </div>
                          <div *ngIf="field.name === 'Problem Category' && !mainProblemDropDownValue">
                            <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                              class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                              placeholder="select" [readonly]="!field.isEditable"
                              (onSelect)="ProblemCategoryVFun($event,field)"
                              (onChange)="ProblemCategoryVFun($event,field)" [filter]="true" filterBy="label">
                            </p-dropdown>
                          </div>
                          <div *ngIf="field.name === 'Dependent upon (State/CG)' && mainNewVariableCheckDepenedent">
                            <p-dropdown [options]="dependentVariavbles" optionlabel="label" optionValue="value"
                              class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                              placeholder="select" [readonly]="!field.isEditable"
                              (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                              [filter]="true" filterBy="label">
                            </p-dropdown>
                          </div>
                          <div *ngIf="field.name === 'Dependent upon (State/CG)' && !mainNewVariableCheckDepenedent">
                            <p-dropdown [options]="field.selectItems" optionlabel="label" optionValue="value"
                              class="p-inputtext-sm" [formControlName]="field.fld_FieldName" required="field.required"
                              placeholder="select" [readonly]="!field.isEditable"
                              (onSelect)="DependentuponFunc($event,field)" (onChange)="DependentuponFunc($event,field)"
                              [filter]="true" filterBy="label">
                            </p-dropdown>
                          </div>
                        </ng-container>

                      </span>

                      <span *ngIf="field.controlType.value == 3 && field.displayInClient==true && field.isUsed==true">
                        <div>
                          <p-checkbox binary="true" inputId="binary" [formControlName]="field.fld_FieldName"
                            required="field.required" [readonly]="!field.isEditable">
                          </p-checkbox>
                        </div>
                      </span>

                      <span *ngIf="field.controlType.value == 4 && field.displayInClient==true && field.isUsed==true">
                        <div>
                          <p-radioButton [formControlName]="field.fld_FieldName" required="field.required"
                            [readonly]="!field.isEditable">
                          </p-radioButton>
                        </div>
                      </span>

                      <span *ngIf="field.controlType.value == 5 && field.displayInClient==true && field.isUsed==true">
                        <div>
                          <p-listbox [formControlName]="field.fld_FieldName" optionLabel="name"
                            required="field.required" [readonly]="!field.isEditable"></p-listbox>
                        </div>
                      </span>

                      <span *ngIf="field.controlType.value == 1 && field.displayInClient==true && field.isUsed==true">
                        <div>
                          <textarea pInputTextarea [formControlName]="field.fld_FieldName" required="field.required"
                            [readonly]="!field.isEditable"></textarea>
                        </div>
                      </span>

                      <span *ngIf="field.controlType.value == 8 && field.displayInClient==true && field.isUsed==true">
                        <div>
                          <p-multiSelect [options]="cities" class="p-inputtext-sm" optionLabel="name"
                            required="field.required" [formControlName]="field.fld_FieldName" placeholder="select"
                            [readonly]="!field.isEditable"></p-multiSelect>
                        </div>
                      </span>
                    </div>
                  </ng-container>
                </div>
                <!-- <div class="field col-12 md:col-5 flex">
                          <p-button label="New Ticket" (onClick)="newTicket()" [hidden]="!ticketEnable"></p-button>
                          <div style="margin: 0 5px;"></div>
                          <p-button label="Open DM Chat" (click)="dmChat()" [hidden]="!liveDM"></p-button>
                      </div> -->
              </div>
            </div>
          </form>
          <!-- assign by && Ticket Status -->
          <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Assigned By:<span style="color:red">*</span></div>
            <div class="col-12 mb-0 md:col-3 md:mb-0">
              <input type="text" pInputText [(ngModel)]="selectedAssignedBy" readonly="true" class="p-inputtext-sm" />
            </div>

            <div class="col-12 mb-0 md:col-2 md:mb-0">Ticket Status<span style="color:red">*</span></div>
            <div class="col-12 mb-0 md:col-3 md:mb-0">
              <p-dropdown class="p-inputtext-sm" id="ticketStatus" [options]="ticketStatusDropdownData"
                [disabled]="disabledTicketFields" [filter]="true" filterBy="label" optionLabel="label"
                optionValue="value" [(ngModel)]="selectedticketStatus" [showClear]="true" placeholder="Select"
                (onClick)="getTicketStatus()">
                <ng-template let-selectedType pTemplate="item">
                  <div class="selectedType-item">
                    <div>{{selectedType.label}}</div>
                  </div>
                </ng-template>
              </p-dropdown>
            </div>
          </div>

          <!-- ticket type -->
          <!-- <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
                  <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type:<span style="color:red">*</span></div>
                  <div class="col-12 mb-0 md:col-3 md:mb-0">
                      <i class="pi pi-chevron-circle-left" style="font-size: 1.7rem"
                          (click)="previousIconTicketType()"></i>
                      <p-dropdown class="p-inputtext-sm" id="ticketType" [options]="ticketTypeDropdownData"
                          appendTo="body" [disabled]="disabledTicketFields" [filter]="true" filterBy="label"
                          optionLabel="label" optionValue="value" [(ngModel)]="selectedTicketType" [showClear]="true"
                          placeholder="Select ">
                          <ng-template let-selectedType pTemplate="item">
                              <div class="selectedType-item">
                                  <div>{{selectedType.label}}</div>
                              </div>
                          </ng-template>
                      </p-dropdown>
                      <i class="pi pi-chevron-circle-right" style="font-size: 1.7rem"
                          (click)="forwardIconTicketType()"></i>
                  </div>
              </div> -->

          <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0 ">Ticket Type:<span style="color:red">*</span></div>

            <!-- 1st Dropdown -->
            <div class="col-12 mb-0 md:col-3 md:mb-0" *ngFor="let item of arrObj; let i = index">
              <p-dropdown class="p-inputtext-sm" id="ticketType[i]" [options]="ticketTypeDropdownData[i]"
                [disabled]="disabledTicketFields" appendTo="body" [filter]="true" filterBy="label" optionLabel="label"
                optionValue="value" [(ngModel)]="selectedTicketType[i] " [showClear]="true" placeholder="Select"
                (onChange)="ticketTypeDropdown(i)">
                <ng-template let-selectedType pTemplate="item">
                  <div class="selectedType-item">
                    <div>{{selectedType.label}}</div>
                  </div>
                </ng-template>
              </p-dropdown>
            </div>

          </div>


          <!-- tree -->
          <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-12 md:mb-0">Tree : {{tree}}</div>

          </div>

          <!-- voice file -->
          <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;"
            *ngIf="voicefile">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Voice File:</div>
            <div class="col-12 mb-0 md:col-6 md:mb-0">
              <audio controls>
                <source [src]="voicefile" type="audio/wav">
              </audio>
            </div>
          </div>
        </div>

     

        <div class="cardTicket" *ngIf="showTicketCard">
          <div class="grid forms-grid flex-row p-fluid" style="padding-left: 10px !important; margin-top:10px;">
            <div class="col-12 mb-0 md:col-2 md:mb-0">Agent Remarks:</div>
            <div class="col-12 mb-0 md:col-6 md:mb-0">
              <textarea rows="2" cols="40" id="agentRemarks" name="agentRemarks" pInputTextarea class="p-inputtext"
                [disabled]="disabledTicketFields" placeholder=" " [(ngModel)]="agentRemarks"></textarea>
            </div>
          </div>
        </div>


        <div class="cardTicket" *ngIf="showTicketCard">
          <div class="grid forms-grid flex-row p-fluid"
            style="padding-left: 10px !important; margin-top:10px;padding-bottom: 11px;">

            <div class="col-12 mb-0 md:col-1 md:mb-0">
              <div>Ticket Id</div>
            </div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
              <div><input class="p-inputtext-sm" type="text" pInputText [(ngModel)]="ticketNo" /></div>
            </div>

            <div class="col-12 mb-0 md:col-3 md:mb-0">
              <button (click)="callHistory()" pButton pRipple type="button" label="Ticket History"
                style="background: #128c7e;    white-space: pre;
    width: 100%;">
              </button>
            </div>
            <div class="col-12 mb-0 md:col-2 md:mb-0">
              <button pButton pRipple type="submit" style="background: #128c7e;" label="Save"
                (click)="saveDynamicLeadCustField()" *ngIf="showSaveButton">
              </button>
              <button pButton (click)="updateTiecket()" pButton pRipple style="background: #128c7e;" type="Update"
                label="Update" *ngIf="showUpdateButton">
              </button>
            </div>
          </div>
        </div>
      </div>



    </div>
  </div>
</p-dialog>
<!-- contacts dialog -->
<p-dialog header="Share Invite" [modal]="true" [(visible)]="smsVariableTrueFalse" [style]="{ width: '25rem' }">
  <!-- <span class="p-text-secondary block mb-5">Update your information.</span> -->
  <div class="flex align-items-center gap-3 mb-3">
    <label for="username" class="font-semibold w-6rem">Number</label>
    <!-- <input pInputText id="username" class="flex-auto" [(ngModel)]="selectedTemp" autocomplete="off" /> -->
    <p-inputNumber [(ngModel)]="smsNumber" mode="decimal" inputId="withoutgrouping"
      [useGrouping]="false"></p-inputNumber>
  </div>
  <!-- <div class="flex align-items-center gap-3 mb-5">
      <label for="email" class="font-semibold w-6rem">Email</label>
      <input pInputText id="email" class="flex-auto" autocomplete="off" />
  </div> -->
  <div class="flex justify-content-end gap-2">
    <p-button label="Cancel" severity="secondary" style="margin-right: 10px;"
      (onClick)="smsVariableTrueFalse = false"></p-button>
    <p-button label="Save" (click)="sendSMSDetails()"></p-button>
  </div>
</p-dialog>